
> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: http-error  tenantId: 404  unique_name: POST /sdk [Connection|close|Content-Length|441|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337] details: {}
action: http-error  tenantId: 404  unique_name: GET /nmaplowercheck1547666734 [Connection|close|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337] details: {}
action: http-error  tenantId: 404  unique_name: GET /evox/about [Connection|close|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337] details: {}
action: http-error  tenantId: 404  unique_name: GET /HNAP1 [Connection|close|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337] details: {}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
base64Decoded========{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}
解码后user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
fromToken----user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所stu15@usmie.com
成功了
action: server-signin  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
(node:12450) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
连接数据库成功
23232131
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法
model+++++++++++++{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法数据库
{ _id: 5c3e873dd3ec03ea5a9bcd86,
  acceptedEula: true,
  isLicensed: true,
  lastLicenseCheck: '2019-01-10 11:11:11',
  lastRoleCheck: '2019-01-10 12:12:12',
  name: 'pmo_bp',
  nickname: '',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '',
  role: 'student',
  skin: '',
  tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  trialsAllowed: 20,
  trialsUsed: 1,
  unique_name: 'stu15@usmie.com',
  licenseType: '',
  deleted: '2019-01-17 12:12:12',
  clientSettings: '',
  experienceState: '',
  PartitionKey: '',
  RowKey: '',
  TimeStamp: 1546998515 }
final+++++++++++++++[object Object]
userEntity------{"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser-------true
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser111
updateExistingUser1111
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"0832e261-2a2b-4317-a967-83c1e33155db","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '0832e261-2a2b-4317-a967-83c1e33155db',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamedevelopmentusers
updateExistingUser2222
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"df978d3b-5603-46bf-bd0c-d3f4cf73cd13","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: 'df978d3b-5603-46bf-bd0c-d3f4cf73cd13',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamestagingmeeusers
updateExistingUser3333
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"0832e261-2a2b-4317-a967-83c1e33155db","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"df978d3b-5603-46bf-bd0c-d3f4cf73cd13","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
sign-----------[object Object]
signedToken-----------38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T08:57:11.025Z|45771c9b28a89a420ac3875f53e77aa639739a8012da34bf0833a6720c6e8b91b5751fe3865c20f21c9ece80befb667658396d68d5385f6c2352d0682356f13de541c7a26d6cae7af21c3f03a2f61954fd9c5abe5e88278ac7b72e15b9009848879ce4e568323228da1e7df05ee1c2d1b1e4b3051e4a77015341ea2b25e4e57751dba30aaf4d650f932daac09139467dd978dfbc0f3396733e70fd79456e213a8d4cb72531b92417d94899f82c05cd6e1d848b9a0b971a9ecd14b02c55a298e3b2f24098ce8600517befc6f6c325450b07286b0767d11e1afbe33c971bffa740605feb084b28b1921be7d0f7800fba10ef7afee7d2ae9ff9bb1feb452e8c7b0f
user--------111{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"df978d3b-5603-46bf-bd0c-d3f4cf73cd13","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}
userid--------111"df978d3b-5603-46bf-bd0c-d3f4cf73cd13"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"df978d3b-5603-46bf-bd0c-d3f4cf73cd13","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T08:57:11.025Z|45771c9b28a89a420ac3875f53e77aa639739a8012da34bf0833a6720c6e8b91b5751fe3865c20f21c9ece80befb667658396d68d5385f6c2352d0682356f13de541c7a26d6cae7af21c3f03a2f61954fd9c5abe5e88278ac7b72e15b9009848879ce4e568323228da1e7df05ee1c2d1b1e4b3051e4a77015341ea2b25e4e57751dba30aaf4d650f932daac09139467dd978dfbc0f3396733e70fd79456e213a8d4cb72531b92417d94899f82c05cd6e1d848b9a0b971a9ecd14b02c55a298e3b2f24098ce8600517befc6f6c325450b07286b0767d11e1afbe33c971bffa740605feb084b28b1921be7d0f7800fba10ef7afee7d2ae9ff9bb1feb452e8c7b0f","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"tenantId\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57\",\"name\":\"stu15 usmie_com\",\"skin\":\"EduSkins_Alex\",\"oid\":\"df978d3b-5603-46bf-bd0c-d3f4cf73cd13\",\"nickname\":\"stu15u\",\"signedToken\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T08:57:11.025Z|45771c9b28a89a420ac3875f53e77aa639739a8012da34bf0833a6720c6e8b91b5751fe3865c20f21c9ece80befb667658396d68d5385f6c2352d0682356f13de541c7a26d6cae7af21c3f03a2f61954fd9c5abe5e88278ac7b72e15b9009848879ce4e568323228da1e7df05ee1c2d1b1e4b3051e4a77015341ea2b25e4e57751dba30aaf4d650f932daac09139467dd978dfbc0f3396733e70fd79456e213a8d4cb72531b92417d94899f82c05cd6e1d848b9a0b971a9ecd14b02c55a298e3b2f24098ce8600517befc6f6c325450b07286b0767d11e1afbe33c971bffa740605feb084b28b1921be7d0f7800fba10ef7afee7d2ae9ff9bb1feb452e8c7b0f\",\"clientSettings\":\"\",\"popup\":{\"id\":\"2e81d886-1054-4d74-a2a4-452bf5607e5c\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Press \\\"C\\\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"}}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"df978d3b-5603-46bf-bd0c-d3f4cf73cd13","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T08:57:11.025Z|45771c9b28a89a420ac3875f53e77aa639739a8012da34bf0833a6720c6e8b91b5751fe3865c20f21c9ece80befb667658396d68d5385f6c2352d0682356f13de541c7a26d6cae7af21c3f03a2f61954fd9c5abe5e88278ac7b72e15b9009848879ce4e568323228da1e7df05ee1c2d1b1e4b3051e4a77015341ea2b25e4e57751dba30aaf4d650f932daac09139467dd978dfbc0f3396733e70fd79456e213a8d4cb72531b92417d94899f82c05cd6e1d848b9a0b971a9ecd14b02c55a298e3b2f24098ce8600517befc6f6c325450b07286b0767d11e1afbe33c971bffa740605feb084b28b1921be7d0f7800fba10ef7afee7d2ae9ff9bb1feb452e8c7b0f","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
23232qqqqqqqqqqqqq131

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
events.js:167
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::1337
    at Server.setupListenHandle [as _listen2] (net.js:1290:14)
    at listenInCluster (net.js:1338:12)
    at Server.listen (net.js:1425:7)
    at Function.listen (/opt/server/node_modules/express/lib/application.js:618:24)
    at Object.<anonymous> (/opt/server/js/server.js:333:5)
    at Module._compile (internal/modules/cjs/loader.js:689:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)
    at Module.load (internal/modules/cjs/loader.js:599:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)
    at Function.Module._load (internal/modules/cjs/loader.js:530:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:742:12)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)
Emitted 'error' event at:
    at emitErrorNT (net.js:1317:8)
    at process._tickCallback (internal/process/next_tick.js:63:19)
    at Function.Module.runMain (internal/modules/cjs/loader.js:745:11)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! Eric@1.0.0 start: `node js/server.js`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the Eric@1.0.0 start script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /root/.npm/_logs/2019-01-17T09_10_38_192Z-debug.log
base64Decoded========{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}
解码后user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
fromToken----user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所stu15@usmie.com
成功了
action: server-signin  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
23232131
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法
model+++++++++++++{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法数据库
{ _id: 5c3e873dd3ec03ea5a9bcd86,
  acceptedEula: true,
  isLicensed: true,
  lastLicenseCheck: '2019-01-10 11:11:11',
  lastRoleCheck: '2019-01-10 12:12:12',
  name: 'pmo_bp',
  nickname: '',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '',
  role: 'student',
  skin: '',
  tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  trialsAllowed: 20,
  trialsUsed: 1,
  unique_name: 'stu15@usmie.com',
  licenseType: '',
  deleted: '2019-01-17 12:12:12',
  clientSettings: '',
  experienceState: '',
  PartitionKey: '',
  RowKey: '',
  TimeStamp: 1546998515 }
final+++++++++++++++[object Object]
userEntity------{"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser-------true
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser111
updateExistingUser1111
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"2c2787c1-87b4-4ae7-84d5-a307c37b206d","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '2c2787c1-87b4-4ae7-84d5-a307c37b206d',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamedevelopmentusers
updateExistingUser2222
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"4585f50a-e994-4cf4-b5f2-7055401c2d42","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '4585f50a-e994-4cf4-b5f2-7055401c2d42',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamestagingmeeusers
updateExistingUser3333
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"4585f50a-e994-4cf4-b5f2-7055401c2d42","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"2c2787c1-87b4-4ae7-84d5-a307c37b206d","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
sign-----------[object Object]
signedToken-----------38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T09:12:04.280Z|86a4b92d091106b0c5767d7e13c6c243665eb4e208a9763c4b16668e828743e29b7a2304f97e5a176e22a96b311997c76ed6a6c64d82e9ca1af85a3d860b44eaa05652999db73d5e63b932256ed9405077c4a12362f1980a06f3ab2c27e02800e34d94f2abb2179cd5568034da6d766e45bc758cdd2a119b59c7fbbf98803410acb1b4d52f6cf6078dadffcc62b96d594398e8b12dc126757f9e3d239f4f3e7610ee6c17b35d867814642cba15da2e0476f96a683e13e775078f3ad98d2621df4954e59a009bfff161e868ead33b174c9196a3968099adc7a7b76cef1b8838e7e4a7b9aa4ad49a62fe06cbf4465dcac3f108362bf0b6a159e804d9a8552dc180
user--------111{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"4585f50a-e994-4cf4-b5f2-7055401c2d42","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}
userid--------111"4585f50a-e994-4cf4-b5f2-7055401c2d42"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"4585f50a-e994-4cf4-b5f2-7055401c2d42","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T09:12:04.280Z|86a4b92d091106b0c5767d7e13c6c243665eb4e208a9763c4b16668e828743e29b7a2304f97e5a176e22a96b311997c76ed6a6c64d82e9ca1af85a3d860b44eaa05652999db73d5e63b932256ed9405077c4a12362f1980a06f3ab2c27e02800e34d94f2abb2179cd5568034da6d766e45bc758cdd2a119b59c7fbbf98803410acb1b4d52f6cf6078dadffcc62b96d594398e8b12dc126757f9e3d239f4f3e7610ee6c17b35d867814642cba15da2e0476f96a683e13e775078f3ad98d2621df4954e59a009bfff161e868ead33b174c9196a3968099adc7a7b76cef1b8838e7e4a7b9aa4ad49a62fe06cbf4465dcac3f108362bf0b6a159e804d9a8552dc180","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"tenantId\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57\",\"name\":\"stu15 usmie_com\",\"skin\":\"EduSkins_Alex\",\"oid\":\"4585f50a-e994-4cf4-b5f2-7055401c2d42\",\"nickname\":\"stu15u\",\"signedToken\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T09:12:04.280Z|86a4b92d091106b0c5767d7e13c6c243665eb4e208a9763c4b16668e828743e29b7a2304f97e5a176e22a96b311997c76ed6a6c64d82e9ca1af85a3d860b44eaa05652999db73d5e63b932256ed9405077c4a12362f1980a06f3ab2c27e02800e34d94f2abb2179cd5568034da6d766e45bc758cdd2a119b59c7fbbf98803410acb1b4d52f6cf6078dadffcc62b96d594398e8b12dc126757f9e3d239f4f3e7610ee6c17b35d867814642cba15da2e0476f96a683e13e775078f3ad98d2621df4954e59a009bfff161e868ead33b174c9196a3968099adc7a7b76cef1b8838e7e4a7b9aa4ad49a62fe06cbf4465dcac3f108362bf0b6a159e804d9a8552dc180\",\"clientSettings\":\"\",\"popup\":{\"id\":\"2e81d886-1054-4d74-a2a4-452bf5607e5c\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Press \\\"C\\\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"}}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"4585f50a-e994-4cf4-b5f2-7055401c2d42","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T09:12:04.280Z|86a4b92d091106b0c5767d7e13c6c243665eb4e208a9763c4b16668e828743e29b7a2304f97e5a176e22a96b311997c76ed6a6c64d82e9ca1af85a3d860b44eaa05652999db73d5e63b932256ed9405077c4a12362f1980a06f3ab2c27e02800e34d94f2abb2179cd5568034da6d766e45bc758cdd2a119b59c7fbbf98803410acb1b4d52f6cf6078dadffcc62b96d594398e8b12dc126757f9e3d239f4f3e7610ee6c17b35d867814642cba15da2e0476f96a683e13e775078f3ad98d2621df4954e59a009bfff161e868ead33b174c9196a3968099adc7a7b76cef1b8838e7e4a7b9aa4ad49a62fe06cbf4465dcac3f108362bf0b6a159e804d9a8552dc180","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
23232qqqqqqqqqqqqq131

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
events.js:167
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::1337
    at Server.setupListenHandle [as _listen2] (net.js:1290:14)
    at listenInCluster (net.js:1338:12)
    at Server.listen (net.js:1425:7)
    at Function.listen (/opt/server/node_modules/express/lib/application.js:618:24)
    at Object.<anonymous> (/opt/server/js/server.js:333:5)
    at Module._compile (internal/modules/cjs/loader.js:689:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)
    at Module.load (internal/modules/cjs/loader.js:599:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)
    at Function.Module._load (internal/modules/cjs/loader.js:530:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:742:12)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)
Emitted 'error' event at:
    at emitErrorNT (net.js:1317:8)
    at process._tickCallback (internal/process/next_tick.js:63:19)
    at Function.Module.runMain (internal/modules/cjs/loader.js:745:11)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! Eric@1.0.0 start: `node js/server.js`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the Eric@1.0.0 start script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /root/.npm/_logs/2019-01-17T10_26_26_155Z-debug.log
base64Decoded========{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}
解码后user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
fromToken----user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所stu15@usmie.com
成功了
action: server-signin  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
23232131
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法
model+++++++++++++{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法数据库
{ _id: 5c3e873dd3ec03ea5a9bcd86,
  acceptedEula: true,
  isLicensed: true,
  lastLicenseCheck: '2019-01-10 11:11:11',
  lastRoleCheck: '2019-01-10 12:12:12',
  name: 'pmo_bp',
  nickname: '',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '',
  role: 'student',
  skin: '',
  tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  trialsAllowed: 20,
  trialsUsed: 1,
  unique_name: 'stu15@usmie.com',
  licenseType: '',
  deleted: '2019-01-17 12:12:12',
  clientSettings: '',
  experienceState: '',
  PartitionKey: '',
  RowKey: '',
  TimeStamp: 1546998515 }
final+++++++++++++++[object Object]
userEntity------{"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser-------true
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser111
updateExistingUser1111
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"3a9af94a-45ea-4070-a48a-420fd03045cb","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '3a9af94a-45ea-4070-a48a-420fd03045cb',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamedevelopmentusers
updateExistingUser2222
undefined
userToUpdate000{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"938665e9-5900-4c6e-9b3d-4fe8fecd4119","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"trialsAllowed":10}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  unique_name: 'stu15@usmie.com',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: undefined,
  name: 'ブラック フラグ',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  anonimizedOid: '938665e9-5900-4c6e-9b3d-4fe8fecd4119',
  skin: 'EduSkins_Alex',
  nickname: 'stu15u',
  isLicensed: true,
  licenseType: undefined,
  trialsAllowed: 10 }
tableNamestagingmeeusers
updateExistingUser3333
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"938665e9-5900-4c6e-9b3d-4fe8fecd4119","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"3a9af94a-45ea-4070-a48a-420fd03045cb","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}}
sign-----------[object Object]
signedToken-----------38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T10:26:30.960Z|51dfbebe9e24dd77501aeb5adfdd5239745861ea912216cd6f30c436e9f3a9578c734ef301963f0e5d3c34ae2f04ebc665d4295fb3f1a7583e5b5c71307401ce3ebcd584569e6f4c81d4352639e7aab0c378ee03e1edffa6e5b8f9bcccabb48d90be01d55f88a7b4384ab5feb2084da177d907191b51029018ae416abc1382850c04fa1cd1c4b8e1880688421aeefc7b6116e23ae9272699ec6d090bb6d6b68a43a85b41e55f885b9e5e874928fc5594057ead710974c72d0b9639d6d7a11ee98e3558b91125bef2d9e5f89168d3f500124d4ca6dfc1531765cf6bd48deb33c7d1ff62fa6a20c0e991de28e3669375473a83f2f6232c3366220c2728c08ec1b3
user--------111{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"name":"ブラック フラグ","nickname":"stu15u","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"938665e9-5900-4c6e-9b3d-4fe8fecd4119","skin":"EduSkins_Alex","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"stu15@usmie.com","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}
userid--------111"938665e9-5900-4c6e-9b3d-4fe8fecd4119"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"938665e9-5900-4c6e-9b3d-4fe8fecd4119","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T10:26:30.960Z|51dfbebe9e24dd77501aeb5adfdd5239745861ea912216cd6f30c436e9f3a9578c734ef301963f0e5d3c34ae2f04ebc665d4295fb3f1a7583e5b5c71307401ce3ebcd584569e6f4c81d4352639e7aab0c378ee03e1edffa6e5b8f9bcccabb48d90be01d55f88a7b4384ab5feb2084da177d907191b51029018ae416abc1382850c04fa1cd1c4b8e1880688421aeefc7b6116e23ae9272699ec6d090bb6d6b68a43a85b41e55f885b9e5e874928fc5594057ead710974c72d0b9639d6d7a11ee98e3558b91125bef2d9e5f89168d3f500124d4ca6dfc1531765cf6bd48deb33c7d1ff62fa6a20c0e991de28e3669375473a83f2f6232c3366220c2728c08ec1b3","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"tenantId\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57\",\"name\":\"stu15 usmie_com\",\"skin\":\"EduSkins_Alex\",\"oid\":\"938665e9-5900-4c6e-9b3d-4fe8fecd4119\",\"nickname\":\"stu15u\",\"signedToken\":\"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T10:26:30.960Z|51dfbebe9e24dd77501aeb5adfdd5239745861ea912216cd6f30c436e9f3a9578c734ef301963f0e5d3c34ae2f04ebc665d4295fb3f1a7583e5b5c71307401ce3ebcd584569e6f4c81d4352639e7aab0c378ee03e1edffa6e5b8f9bcccabb48d90be01d55f88a7b4384ab5feb2084da177d907191b51029018ae416abc1382850c04fa1cd1c4b8e1880688421aeefc7b6116e23ae9272699ec6d090bb6d6b68a43a85b41e55f885b9e5e874928fc5594057ead710974c72d0b9639d6d7a11ee98e3558b91125bef2d9e5f89168d3f500124d4ca6dfc1531765cf6bd48deb33c7d1ff62fa6a20c0e991de28e3669375473a83f2f6232c3366220c2728c08ec1b3\",\"clientSettings\":\"\",\"popup\":{\"id\":\"2e81d886-1054-4d74-a2a4-452bf5607e5c\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Press \\\"C\\\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"}}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","name":"stu15 usmie_com","skin":"EduSkins_Alex","oid":"938665e9-5900-4c6e-9b3d-4fe8fecd4119","nickname":"stu15u","signedToken":"38dd6634-1031-4c50-a9b4-d16cd9d97d57|d2bb1fae-fe7e-4473-a161-92aefee52a3d|2019-01-27T10:26:30.960Z|51dfbebe9e24dd77501aeb5adfdd5239745861ea912216cd6f30c436e9f3a9578c734ef301963f0e5d3c34ae2f04ebc665d4295fb3f1a7583e5b5c71307401ce3ebcd584569e6f4c81d4352639e7aab0c378ee03e1edffa6e5b8f9bcccabb48d90be01d55f88a7b4384ab5feb2084da177d907191b51029018ae416abc1382850c04fa1cd1c4b8e1880688421aeefc7b6116e23ae9272699ec6d090bb6d6b68a43a85b41e55f885b9e5e874928fc5594057ead710974c72d0b9639d6d7a11ee98e3558b91125bef2d9e5f89168d3f500124d4ca6dfc1531765cf6bd48deb33c7d1ff62fa6a20c0e991de28e3669375473a83f2f6232c3366220c2728c08ec1b3","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
23232qqqqqqqqqqqqq131
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
成功了
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
23232131
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
model+++++++++++++{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法数据库
null
final+++++++++++++++null
userEntity------{"entity":null,"exists":true}
isExistingUser-------true
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":null,"exists":true}
action: signin-error  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {}
eeeewwwwww
连接数据库成功

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
npm ERR! missing script: startU
npm ERR! 
npm ERR! Did you mean this?
npm ERR!     start

npm ERR! A complete log of this run can be found in:
npm ERR!     /root/.npm/_logs/2019-01-17T13_18_35_819Z-debug.log

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
base64Decoded========{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","build":"10506000","clientVersion":"291","displayVersion":"1.5.6","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
(node:8624) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+null
userEntity------{"entity":null,"exists":false}
isExistingUser-------false
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":null,"exists":false}
action: signin-error  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"errno":-2,"syscall":"open","code":"ENOENT","path":"server.key"}
eeeewwwwww
连接数据库成功
base64Decoded========{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}
解码后user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
fromToken----user{"userName":"stu15@usmie.com","profile":{"aud":"https://meeservices.minecraft.net","iss":"https://sts.windows.net/38dd6634-1031-4c50-a9b4-d16cd9d97d57/","iat":1547420734,"nbf":1547420734,"exp":1547424634,"acr":"1","aio":"42JgYIgT/qsYOIn5dOWl7xsfBcotVOMq9eYwfnE322HtyXXFMksA","amr":["pwd"],"appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","appidacr":"0","deviceid":"d8387cc9-f676-4c22-b24b-74a7790fbc71","family_name":"フラグ","given_name":"ブラック","ipaddr":"73.225.99.122","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"t6qAg90jCLrex51aabS4Zqyf8_aSpHxTuB9B9jpvpL8","tid":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","upn":"stu15@usmie.com","uti":"6Os2Y15vO0KMsSppdIFTAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所stu15@usmie.com
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","build":"10506000","clientVersion":"291","displayVersion":"1.5.6","identityToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSIsImtpZCI6Im5iQ3dXMTF3M1hrQi14VWFYd0tSU0xqTUhHUSJ9.eyJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8zOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTcvIiwiaWF0IjoxNTQ3NDIwNzM0LCJuYmYiOjE1NDc0MjA3MzQsImV4cCI6MTU0NzQyNDYzNCwiYWNyIjoiMSIsImFpbyI6IjQySmdZSWdUL3FzWU9JbjVkT1dsN3hzZkJjb3RWT01xOWVZd2ZuRTMyMkh0eVhYRk1rc0EiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiYjM2YjE0MzItMWExYy00YzgyLTliNzYtMjRkZTFjYWI0MmYyIiwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJkODM4N2NjOS1mNjc2LTRjMjItYjI0Yi03NGE3NzkwZmJjNzEiLCJmYW1pbHlfbmFtZSI6IuODleODqeOCsCIsImdpdmVuX25hbWUiOiLjg5bjg6njg4Pjgq8iLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwibmFtZSI6IuODluODqeODg-OCryDjg5Xjg6njgrAiLCJvaWQiOiJkMmJiMWZhZS1mZTdlLTQ0NzMtYTE2MS05MmFlZmVlNTJhM2QiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6InQ2cUFnOTBqQ0xyZXg1MWFhYlM0WnF5ZjhfYVNwSHhUdUI5QjlqcHZwTDgiLCJ0aWQiOiIzOGRkNjYzNC0xMDMxLTRjNTAtYTliNC1kMTZjZDlkOTdkNTciLCJ1bmlxdWVfbmFtZSI6InN0dTE1QHVzbWllLmNvbSIsInVwbiI6InN0dTE1QHVzbWllLmNvbSIsInV0aSI6IjZPczJZMTV2TzBLTXNTcHBkSUZUQUEiLCJ2ZXIiOiIxLjAifQ.thEeWYdxxfhCwCF_KTXoFV_Urv-ZKlo10tU-Bl9hOiVGY-3a4xqWl_D3CqhONeUr_WxxEtCqNWpPoj69X4eiXPkKBQXyGewWkOjTA3FYtSbbWC6FY0PiPJyq5SHBwnKJ7N0NCuEp8NZR2_Q1f2gWgCBaWzuN1g0nHBZRhW5FPlvP_3TsUB3XSNSynlaNi5oo_NhMbwwqeHuW8R1FdmEAdIqB4sFduVqRPWWB5TIDTHqmG8gGIoNHupR98l7gUySJ2A9Z2iGOzu0G6M0zfnXH0uSrXybQuRq2fpEK0--ETs4JG6VlJ0uVqBFOnVzcc0Kt1sZN9i0azu2fjBOsWDHmsA","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","unique_name":"stu15@usmie.com"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515}
userEntity------{"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"entity":{"_id":"5c3e873dd3ec03ea5a9bcd86","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-10 11:11:11","lastRoleCheck":"2019-01-10 12:12:12","name":"pmo_bp","nickname":"","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"","role":"student","skin":"","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","trialsAllowed":20,"trialsUsed":1,"unique_name":"stu15@usmie.com","licenseType":"","deleted":"2019-01-17 12:12:12","clientSettings":"","experienceState":"","PartitionKey":"","RowKey":"","TimeStamp":1546998515},"exists":true}
action: signin-error  tenantId: 38dd6634-1031-4c50-a9b4-d16cd9d97d57  unique_name: stu15@usmie.com details: {"errno":-2,"syscall":"open","code":"ENOENT","path":"server.key"}
eeeewwwwww
连接数据库成功
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+null
userEntity------{"entity":null,"exists":false}
isExistingUser-------false
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":null,"exists":false}
action: signin-error  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"errno":-2,"syscall":"open","code":"ENOENT","path":"server.key"}
eeeewwwwww
连接数据库成功

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: http-error  tenantId: 404  unique_name: POST /sdk [User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337|Connection|close|Content-Length|441] details: {}
action: http-error  tenantId: 404  unique_name: GET /nmaplowercheck1547779544 [User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /HNAP1 [User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /evox/about [User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Host|116.196.119.15:1337|Connection|close] details: {}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
base64Decoded========{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","build":"10506000","clientVersion":"291","displayVersion":"1.5.6","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
(node:28333) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T09:47:41.599Z","lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true}
userEntity------{"entity":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T09:47:41.599Z","lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T09:47:41.599Z","lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true},"exists":true}
isExistingUser111
updateExistingUser1111
student
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'student',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '7baa9cb0-4ee2-4737-98e0-34d0aa6edde3',
  skin: 'EduSkins_Alex',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined }
updateExistingUser2222
student
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'student',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '7baa9cb0-4ee2-4737-98e0-34d0aa6edde3',
  skin: 'EduSkins_Alex',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined }
updateExistingUser3333
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 13,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 476,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 16789,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 578,
           [Symbol(triggerId)]: 476 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 af 15 87 02 33 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42407343,
     responseTo: 51,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}}
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 15,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 491,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 16791,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 584,
           [Symbol(triggerId)]: 491 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b1 15 87 02 36 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42407345,
     responseTo: 54,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}}
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T09:51:12.360Z|0e09836aab78c57f020e4ba172426ecbd298558067d940c4ec5a969e89c0601e43137ffb7800957703f513a948f15545c239ae8f8037dcbb8ca83b9c48129c967ea0692ec139d3ebb98e6188be365b77ea111dc21cbb687054b686df6cf5d8334ecb63eb8067d41eca08a7a91a67d74ba33e42cc5505a56f7f8d36c67eebaee288e44dba251bd9c9f220f14dd1e7234087e8f35ac7b4c2a51c2a7cd34bfbcfbbd8d234f9542be5e62d53a545c505ac5d283e3cae105e1ace85105e13397978157cc00ca88150a944ff02b15eca366f3f169cd2dcb2e1454eb0eaee42fc5d9d9e8774558a7059af47f0c1fe9bcdff7adbb96f3a958aa9251c22a21cb336f6c356
user--------111{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}
userid--------111"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"student","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"EduSkins_Alex","oid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T09:51:12.360Z|0e09836aab78c57f020e4ba172426ecbd298558067d940c4ec5a969e89c0601e43137ffb7800957703f513a948f15545c239ae8f8037dcbb8ca83b9c48129c967ea0692ec139d3ebb98e6188be365b77ea111dc21cbb687054b686df6cf5d8334ecb63eb8067d41eca08a7a91a67d74ba33e42cc5505a56f7f8d36c67eebaee288e44dba251bd9c9f220f14dd1e7234087e8f35ac7b4c2a51c2a7cd34bfbcfbbd8d234f9542be5e62d53a545c505ac5d283e3cae105e1ace85105e13397978157cc00ca88150a944ff02b15eca366f3f169cd2dcb2e1454eb0eaee42fc5d9d9e8774558a7059af47f0c1fe9bcdff7adbb96f3a958aa9251c22a21cb336f6c356","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"student\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"test190117\",\"skin\":\"EduSkins_Alex\",\"oid\":\"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3\",\"nickname\":\"test190117\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T09:51:12.360Z|0e09836aab78c57f020e4ba172426ecbd298558067d940c4ec5a969e89c0601e43137ffb7800957703f513a948f15545c239ae8f8037dcbb8ca83b9c48129c967ea0692ec139d3ebb98e6188be365b77ea111dc21cbb687054b686df6cf5d8334ecb63eb8067d41eca08a7a91a67d74ba33e42cc5505a56f7f8d36c67eebaee288e44dba251bd9c9f220f14dd1e7234087e8f35ac7b4c2a51c2a7cd34bfbcfbbd8d234f9542be5e62d53a545c505ac5d283e3cae105e1ace85105e13397978157cc00ca88150a944ff02b15eca366f3f169cd2dcb2e1454eb0eaee42fc5d9d9e8774558a7059af47f0c1fe9bcdff7adbb96f3a958aa9251c22a21cb336f6c356\",\"clientSettings\":\"\",\"popup\":{\"id\":\"2e81d886-1054-4d74-a2a4-452bf5607e5c\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Press \\\"C\\\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"}}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"student","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"EduSkins_Alex","oid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T09:51:12.360Z|0e09836aab78c57f020e4ba172426ecbd298558067d940c4ec5a969e89c0601e43137ffb7800957703f513a948f15545c239ae8f8037dcbb8ca83b9c48129c967ea0692ec139d3ebb98e6188be365b77ea111dc21cbb687054b686df6cf5d8334ecb63eb8067d41eca08a7a91a67d74ba33e42cc5505a56f7f8d36c67eebaee288e44dba251bd9c9f220f14dd1e7234087e8f35ac7b4c2a51c2a7cd34bfbcfbbd8d234f9542be5e62d53a545c505ac5d283e3cae105e1ace85105e13397978157cc00ca88150a944ff02b15eca366f3f169cd2dcb2e1454eb0eaee42fc5d9d9e8774558a7059af47f0c1fe9bcdff7adbb96f3a958aa9251c22a21cb336f6c356","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
base64Decoded========{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1547653456,"exp":1547653460,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888","user_name":"lancer88888","full_name":"lancer88888","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJXNmZQTjNxNDhaeVR0allLaHY4TXdTNXJEaDVmVUlzYyIsIm5hbWUiOiJsYW5jZXI4ODg4OCIsImFjY291bnQiOiJsYW5jZXI4ODg4OCIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzY1MzQ1NiwibmJmIjoxNTQ3NjUzNDU2LCJleHAiOjE1NDc2NTM0NjAsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.lKubfyHdiGnmGBi5v5-jTonDpXP1Pj1niBaQZgjJC53I38Zfw540L3gKO8TARGZEITB7V4NFe6VmtPuKSWM6XzmgqTHZGBEK7E3JyOdJqkyT9P2b-Hp-MivGSkFWIzVNU9eQctoHdadmnlXNVNf2UzVFx_a7bHk9bPf3EVVbgkGmzcBE08zaifURbi7gMweq9O_eHz80sdMaHgW59CZapUxupn1Z0gUdnFHQMVclfI18ignQ0hpk9Zk62tZDsYb-yN6oZ9jM0lQdVliimfZZM1-nQ8HF1lOTubK_4rA__MXDMQhhpetal2717llWGn8SN91TyYSnof3JyVHKXEDq_Q"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJXNmZQTjNxNDhaeVR0allLaHY4TXdTNXJEaDVmVUlzYyIsIm5hbWUiOiJsYW5jZXI4ODg4OCIsImFjY291bnQiOiJsYW5jZXI4ODg4OCIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzY1MzQ1NiwibmJmIjoxNTQ3NjUzNDU2LCJleHAiOjE1NDc2NTM0NjAsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.lKubfyHdiGnmGBi5v5-jTonDpXP1Pj1niBaQZgjJC53I38Zfw540L3gKO8TARGZEITB7V4NFe6VmtPuKSWM6XzmgqTHZGBEK7E3JyOdJqkyT9P2b-Hp-MivGSkFWIzVNU9eQctoHdadmnlXNVNf2UzVFx_a7bHk9bPf3EVVbgkGmzcBE08zaifURbi7gMweq9O_eHz80sdMaHgW59CZapUxupn1Z0gUdnFHQMVclfI18ignQ0hpk9Zk62tZDsYb-yN6oZ9jM0lQdVliimfZZM1-nQ8HF1lOTubK_4rA__MXDMQhhpetal2717llWGn8SN91TyYSnof3JyVHKXEDq_Q","osVersion":"Win 10.0.16299.15","displayVersion":"1.0.27","platform":"Windows 10 UWP Build(x64)","skin":"red"}
eeeewwwwww
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-01T02:10:10.000Z","lastRoleCheck":"2019-01-01T02:10:10.000Z","name":"lancername","nickname":"lancernickname","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"student","skin":"EduSkins_Alex","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"lancer88888","licenseType":"","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  skin: 'red' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 31,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 1276,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 26685,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 1326,
           [Symbol(triggerId)]: 1276 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 74 17 87 02 6b 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42407796,
     responseTo: 107,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入eula方法
base64Decoded========{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"291","build":"10506000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 43,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 1782,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 31825,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 1832,
           [Symbol(triggerId)]: 1782 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 65 18 87 02 93 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42408037,
     responseTo: 147,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547793413,"nbf":1547793413,"exp":1547797313,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547793413,"nbf":1547793413,"exp":1547797313,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547793413,"nbf":1547793413,"exp":1547797313,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3OTM0MTMsIm5iZiI6MTU0Nzc5MzQxMywiZXhwIjoxNTQ3Nzk3MzEzLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.cLcEW6todLbfx3uNHesb_JxCC2Pn7bx4lUXFxYOTh4mQ9yaiUO3fKjNlYYPsNZDbwOu535NgjiUPlwpgIU4Gk7pJf2yYrkATtQNbUgU7m_QLlQP9ipIfoAwy_9-CvZ7_8AYu0qjhz9KefjegdnkxhfoEy0dEoL-k5bjt3B0F7dBLYii5U7TMBT_q40M_LW2JU7yofINXV8OzYeLBTjpJBOTbv0PETDEBCaEY2LnjhO7qjFyKXhGAOtJlFDdO6Xe4Ujct17QVskUScmAK0usGUnIf-7Wg45pOCB2ShTB5sA0yvEjKsZ0A7nfbLRqmfINfjL80M8drRQpRXg9td1f_Pg","build":"10506000","clientVersion":"291","displayVersion":"1.5.6","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3OTM0MTMsIm5iZiI6MTU0Nzc5MzQxMywiZXhwIjoxNTQ3Nzk3MzEzLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.cLcEW6todLbfx3uNHesb_JxCC2Pn7bx4lUXFxYOTh4mQ9yaiUO3fKjNlYYPsNZDbwOu535NgjiUPlwpgIU4Gk7pJf2yYrkATtQNbUgU7m_QLlQP9ipIfoAwy_9-CvZ7_8AYu0qjhz9KefjegdnkxhfoEy0dEoL-k5bjt3B0F7dBLYii5U7TMBT_q40M_LW2JU7yofINXV8OzYeLBTjpJBOTbv0PETDEBCaEY2LnjhO7qjFyKXhGAOtJlFDdO6Xe4Ujct17QVskUScmAK0usGUnIf-7Wg45pOCB2ShTB5sA0yvEjKsZ0A7nfbLRqmfINfjL80M8drRQpRXg9td1f_Pg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-01T02:10:10.000Z","lastRoleCheck":"2019-01-01T02:10:10.000Z","name":"lancername","nickname":"lancernickname","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"student","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"lancer88888","licenseType":"","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}
userEntity------{"entity":{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-01T02:10:10.000Z","lastRoleCheck":"2019-01-01T02:10:10.000Z","name":"lancername","nickname":"lancernickname","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"student","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"lancer88888","licenseType":"","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":"2019-01-01T02:10:10.000Z","lastRoleCheck":"2019-01-01T02:10:10.000Z","name":"lancername","nickname":"lancernickname","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"student","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":10,"trialsUsed":1,"unique_name":"lancer88888","licenseType":"","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"},"exists":true}
-----getUserRoleRisky----111111
roleteacher
isExistingUser111
updateExistingUser1111
teacher
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-18T09:51:33.856Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","skin":"red","nickname":"lancer88888","isLicensed":true,"acceptedEula":true,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-18T09:51:33.856Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '575bd4e8421b458ea8cc42b20fb0b73b',
  skin: 'red',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true,
  trialsAllowed: 25 }
updateExistingUser2222
teacher
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-18T09:51:33.856Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","skin":"red","nickname":"lancer88888","isLicensed":true,"acceptedEula":true,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-18T09:51:33.856Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '575bd4e8421b458ea8cc42b20fb0b73b',
  skin: 'red',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true,
  trialsAllowed: 25 }
updateExistingUser3333
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 61,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 2499,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 38308,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 2605,
           [Symbol(triggerId)]: 2499 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 98 19 87 02 d4 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42408344,
     responseTo: 212,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":25,"trialsUsed":1,"unique_name":"lancer88888","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}}
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 63,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 2534,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 38310,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 2636,
           [Symbol(triggerId)]: 2534 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 9b 19 87 02 d6 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42408347,
     responseTo: 214,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":25,"trialsUsed":1,"unique_name":"lancer88888","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}}
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-01-28T09:51:33.879Z|470e71866f28d0ccda0f01778f924b100e0081f0f0bef3249d229bd905e58f2cc6ad67c1db6c615f0f33e1beed1dab2f2724b1ba1b69c446bdfe7d4974d03d4fdefbccde6406911169c82a6ae5a41dbb308bb38b3571091228c1315beff90a78128de952c59327ce6a6fa568016c0e950f773f42ab908dc3b8ee620935dcb354cf16b340c66b330043da922f2f3fe17a73964524921132448ceaf3af1ecd8a999ab1a99fabed4cc7a0f08f843af6e97cf7590f313b201a75ddfa5040456979bbff41aacf32ad7a0289d1629a5265064d0712439452eaa0c2856afda50bf42bb09c2af2afe81a45e63b1a80dc010c6fb042627f5403ade475ee75100587dc24b2
user--------111{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":25,"trialsUsed":1,"unique_name":"lancer88888","clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}
userid--------111"575bd4e8421b458ea8cc42b20fb0b73b"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"red","oid":"575bd4e8421b458ea8cc42b20fb0b73b","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-01-28T09:51:33.879Z|470e71866f28d0ccda0f01778f924b100e0081f0f0bef3249d229bd905e58f2cc6ad67c1db6c615f0f33e1beed1dab2f2724b1ba1b69c446bdfe7d4974d03d4fdefbccde6406911169c82a6ae5a41dbb308bb38b3571091228c1315beff90a78128de952c59327ce6a6fa568016c0e950f773f42ab908dc3b8ee620935dcb354cf16b340c66b330043da922f2f3fe17a73964524921132448ceaf3af1ecd8a999ab1a99fabed4cc7a0f08f843af6e97cf7590f313b201a75ddfa5040456979bbff41aacf32ad7a0289d1629a5265064d0712439452eaa0c2856afda50bf42bb09c2af2afe81a45e63b1a80dc010c6fb042627f5403ade475ee75100587dc24b2","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"red\",\"oid\":\"575bd4e8421b458ea8cc42b20fb0b73b\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-01-28T09:51:33.879Z|470e71866f28d0ccda0f01778f924b100e0081f0f0bef3249d229bd905e58f2cc6ad67c1db6c615f0f33e1beed1dab2f2724b1ba1b69c446bdfe7d4974d03d4fdefbccde6406911169c82a6ae5a41dbb308bb38b3571091228c1315beff90a78128de952c59327ce6a6fa568016c0e950f773f42ab908dc3b8ee620935dcb354cf16b340c66b330043da922f2f3fe17a73964524921132448ceaf3af1ecd8a999ab1a99fabed4cc7a0f08f843af6e97cf7590f313b201a75ddfa5040456979bbff41aacf32ad7a0289d1629a5265064d0712439452eaa0c2856afda50bf42bb09c2af2afe81a45e63b1a80dc010c6fb042627f5403ade475ee75100587dc24b2\",\"clientSettings\":\"\",\"popup\":{\"id\":\"5c466b18-7982-4b90-9a20-94901f33c2b7\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \\\"C\\\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"},\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"red","oid":"575bd4e8421b458ea8cc42b20fb0b73b","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-01-28T09:51:33.879Z|470e71866f28d0ccda0f01778f924b100e0081f0f0bef3249d229bd905e58f2cc6ad67c1db6c615f0f33e1beed1dab2f2724b1ba1b69c446bdfe7d4974d03d4fdefbccde6406911169c82a6ae5a41dbb308bb38b3571091228c1315beff90a78128de952c59327ce6a6fa568016c0e950f773f42ab908dc3b8ee620935dcb354cf16b340c66b330043da922f2f3fe17a73964524921132448ceaf3af1ecd8a999ab1a99fabed4cc7a0f08f843af6e97cf7590f313b201a75ddfa5040456979bbff41aacf32ad7a0289d1629a5265064d0712439452eaa0c2856afda50bf42bb09c2af2afe81a45e63b1a80dc010c6fb042627f5403ade475ee75100587dc24b2","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"},"acceptedEula":true}
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"lancer88888","trialsAllowed":"22","trialsUsed":"3"}
eeeewwwwww
看一下这个data：{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":null,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":25,"trialsUsed":1,"unique_name":"lancer88888","licenseType":null,"clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}
进入user
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":null,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":25,"trialsUsed":1,"unique_name":"lancer88888","licenseType":null,"clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  trialsAllowed: 22,
  trialsUsed: 3 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 83,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 3469,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 76342,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 3518,
           [Symbol(triggerId)]: 3469 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 bc 1f 87 02 18 01 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 42409916,
     responseTo: 280,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":null,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":22,"trialsUsed":3,"unique_name":"lancer88888","licenseType":null,"clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: http-error  tenantId: 404  unique_name: GET /favicon.ico [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.2 Safari/605.1.15|Accept|*/*|Accept-Encoding|gzip, deflate|Accept-Language|zh-cn|Proxy-Connection|keep-alive|Referer|http://116.196.119.15:1337/|X-Lantern-Version|5.2.2] details: {}
base64Decoded========{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","build":"10506000","clientVersion":"291","displayVersion":"1.5.6","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
(node:11766) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
连接数据库成功
进入signTheUserIn
newTable
RetrievedEntity{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117"}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true}
userEntity------{"entity":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":10,"acceptedEula":true},"exists":true}
-----getUserRoleRisky----2222222
rolestudent
isExistingUser111
updateExistingUser1111
student
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T14:22:49.179Z","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: 2019-01-18T14:22:49.179Z,
  lastLicenseCheck: undefined,
  role: 'student',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '7baa9cb0-4ee2-4737-98e0-34d0aa6edde3',
  skin: 'EduSkins_Alex',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined }
updateExistingUser2222
student
userToUpdate000{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T14:22:49.179Z","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: 2019-01-18T14:22:49.179Z,
  lastLicenseCheck: undefined,
  role: 'student',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '7baa9cb0-4ee2-4737-98e0-34d0aa6edde3',
  skin: 'EduSkins_Alex',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined }
updateExistingUser3333
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 17,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 650,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 106442,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 740,
           [Symbol(triggerId)]: 650 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 9a 44 91 02 40 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 43074714,
     responseTo: 64,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T14:22:49.179Z","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}}
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 19,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 685,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 106444,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 795,
           [Symbol(triggerId)]: 685 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 9e 44 91 02 43 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 43074718,
     responseTo: 67,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
userInfo-----------qqq{"remainingTrialCount":0,"user":{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T14:22:49.179Z","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}}
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T14:22:49.200Z|593c93718fc411d6b5a9270155b4a23aa302878b9750cbda1eb763da487d790b48bb71447d03cd37d777e50d72bac6430687d8259aa318f04fbbeeca397110e1bffba4c2a2a88dccf554abd26a9051801baf88f8424f198527ec5f6eda143bf9387957e28c032a02ae358f31b4132b2a0061bddae7215b0344b45cf2f3634d7a7190c57ded5a1d712109aa5f7475f1d1b416e1550e147cf90753fdfbdc807bccf86c91d72dd207bfa03649a25c444588b13f725fcb42c11a84844626e957ce4ccc00229f49b656be423a87a265a78ae9c3892ec413c43b6520abff4cb161b3f4e231b0f2b9a6acc19434843961a7698cecaa235a4042dfc4e3f8b0b5aa43cb15
user--------111{"_id":"5c40b7714ec2320d71f25135","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-18T14:22:49.179Z","role":"student","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"trialsAllowed":10,"acceptedEula":true}
userid--------111"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"student","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"EduSkins_Alex","oid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T14:22:49.200Z|593c93718fc411d6b5a9270155b4a23aa302878b9750cbda1eb763da487d790b48bb71447d03cd37d777e50d72bac6430687d8259aa318f04fbbeeca397110e1bffba4c2a2a88dccf554abd26a9051801baf88f8424f198527ec5f6eda143bf9387957e28c032a02ae358f31b4132b2a0061bddae7215b0344b45cf2f3634d7a7190c57ded5a1d712109aa5f7475f1d1b416e1550e147cf90753fdfbdc807bccf86c91d72dd207bfa03649a25c444588b13f725fcb42c11a84844626e957ce4ccc00229f49b656be423a87a265a78ae9c3892ec413c43b6520abff4cb161b3f4e231b0f2b9a6acc19434843961a7698cecaa235a4042dfc4e3f8b0b5aa43cb15","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"student\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"test190117\",\"skin\":\"EduSkins_Alex\",\"oid\":\"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3\",\"nickname\":\"test190117\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T14:22:49.200Z|593c93718fc411d6b5a9270155b4a23aa302878b9750cbda1eb763da487d790b48bb71447d03cd37d777e50d72bac6430687d8259aa318f04fbbeeca397110e1bffba4c2a2a88dccf554abd26a9051801baf88f8424f198527ec5f6eda143bf9387957e28c032a02ae358f31b4132b2a0061bddae7215b0344b45cf2f3634d7a7190c57ded5a1d712109aa5f7475f1d1b416e1550e147cf90753fdfbdc807bccf86c91d72dd207bfa03649a25c444588b13f725fcb42c11a84844626e957ce4ccc00229f49b656be423a87a265a78ae9c3892ec413c43b6520abff4cb161b3f4e231b0f2b9a6acc19434843961a7698cecaa235a4042dfc4e3f8b0b5aa43cb15\",\"clientSettings\":\"\",\"popup\":{\"id\":\"2e81d886-1054-4d74-a2a4-452bf5607e5c\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Press \\\"C\\\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"}}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"student","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"EduSkins_Alex","oid":"7baa9cb0-4ee2-4737-98e0-34d0aa6edde3","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-01-28T14:22:49.200Z|593c93718fc411d6b5a9270155b4a23aa302878b9750cbda1eb763da487d790b48bb71447d03cd37d777e50d72bac6430687d8259aa318f04fbbeeca397110e1bffba4c2a2a88dccf554abd26a9051801baf88f8424f198527ec5f6eda143bf9387957e28c032a02ae358f31b4132b2a0061bddae7215b0344b45cf2f3634d7a7190c57ded5a1d712109aa5f7475f1d1b416e1550e147cf90753fdfbdc807bccf86c91d72dd207bfa03649a25c444588b13f725fcb42c11a84844626e957ce4ccc00229f49b656be423a87a265a78ae9c3892ec413c43b6520abff4cb161b3f4e231b0f2b9a6acc19434843961a7698cecaa235a4042dfc4e3f8b0b5aa43cb15","clientSettings":"","popup":{"id":"2e81d886-1054-4d74-a2a4-452bf5607e5c","title":"Code Builder for Minecraft: Education Edition","text":"Press \"C\" to code! Did you know you can write code in Minecraft? Using Code Builder, you can use block coding or JavaScript to control the Agent. Head to the Minecraft Education website to find fun activities you can do while learning to code, and share with your teacher!","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
action: http-error  tenantId: 404  unique_name: GET /signin [Accept|text/html, application/xhtml+xml, image/jxr, */*|Accept-Language|zh-CN|User-Agent|Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko|Accept-Encoding|gzip, deflate|Host|116.196.119.15:1337|Connection|Keep-Alive] details: {}
action: http-error  tenantId: 404  unique_name: GET /signin [Accept|text/html, application/xhtml+xml, image/jxr, */*|Accept-Language|zh-CN|User-Agent|Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko|Accept-Encoding|gzip, deflate|Host|116.196.119.15:1337|Connection|Keep-Alive] details: {}
action: http-error  tenantId: 404  unique_name: GET /favicon.ico [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (Windows NT 10.0; WOW64; rv:64.0) Gecko/20100101 Firefox/64.0|Accept|text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8|Accept-Language|zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2|Accept-Encoding|gzip, deflate|Connection|keep-alive] details: {}
action: http-error  tenantId: 404  unique_name: GET /favicon.ico [Accept|*/*|UA-CPU|AMD64|Accept-Encoding|gzip, deflate|User-Agent|Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko|Host|116.196.119.15:1337|Connection|Keep-Alive] details: {}
action: getUserInfo  tenantId:   unique_name:  details: undefined
eeeewwwwww
(node:11766) UnhandledPromiseRejectionWarning: TypeError: Cannot read property 'toString' of undefined
    at /opt/server/js/Logger.js:99:54
    at new Promise (<anonymous>)
    at Object.<anonymous> (/opt/server/js/Logger.js:82:16)
    at Generator.next (<anonymous>)
    at /opt/server/js/Logger.js:7:71
    at new Promise (<anonymous>)
    at __awaiter (/opt/server/js/Logger.js:3:12)
    at Object.logActivity (/opt/server/js/Logger.js:78:12)
    at getUserInfo (/opt/server/js/server.js:274:18)
    at Layer.handle [as handle_request] (/opt/server/node_modules/express/lib/router/layer.js:95:5)
    at next (/opt/server/node_modules/express/lib/router/route.js:137:13)
    at Route.dispatch (/opt/server/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/opt/server/node_modules/express/lib/router/layer.js:95:5)
    at /opt/server/node_modules/express/lib/router/index.js:281:22
    at Function.process_params (/opt/server/node_modules/express/lib/router/index.js:335:12)
    at next (/opt/server/node_modules/express/lib/router/index.js:275:10)
    at SendStream.error (/opt/server/node_modules/serve-static/index.js:121:7)
    at SendStream.emit (events.js:182:13)
    at SendStream.error (/opt/server/node_modules/send/index.js:270:17)
    at SendStream.onStatError (/opt/server/node_modules/send/index.js:421:12)
    at next (/opt/server/node_modules/send/index.js:736:16)
    at onstat (/opt/server/node_modules/send/index.js:725:14)
(node:11766) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 2)
(node:11766) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.
看一下这个data：undefined
action: getUserInfo  tenantId:   unique_name:  details: {"message":"lancer88888"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c4174698e327b555eb17ad0","acceptedEula":true,"isLicensed":true,"lastLicenseCheck":null,"lastRoleCheck":"2019-01-18T09:51:33.856Z","name":"lancer88888","nickname":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"575bd4e8421b458ea8cc42b20fb0b73b","role":"teacher","skin":"red","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","trialsAllowed":22,"trialsUsed":3,"unique_name":"lancer88888","licenseType":null,"clientSettings":"","experienceState":"","_class":"com.tb.mongodblisenceser.domain.UserLicenseServer"}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: http-error  tenantId: 404  unique_name: GET /favicon.ico [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.2 Safari/605.1.15|Accept|*/*|Accept-Encoding|gzip, deflate|Accept-Language|zh-cn|If-None-Match|W/"f-Z280BOLXUGgeynAe/z2VTx5EI7Q"|Proxy-Connection|keep-alive|Referer|http://116.196.119.15:1337/|X-Lantern-Version|5.2.2] details: {}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: http-error  tenantId: 404  unique_name: GET /favicon.ico [Accept|*/*|UA-CPU|AMD64|Accept-Encoding|gzip, deflate|User-Agent|Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko|Host|116.196.119.15:1337|Connection|Keep-Alive] details: {}

> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1547710498,"exp":1547714398,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117","user_name":"test190117","full_name":"test190117","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","osVersion":"Win 10.0.16299.15","displayVersion":"1.0.27","platform":"Windows 10 UWP Build(x64)","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
(node:7469) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
进入retrieve方法数据库
连接数据库成功
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"EduSkins_Alex","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 11,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 422,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 7783,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 471,
           [Symbol(triggerId)]: 422 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 5e e5 11 03 28 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51504478,
     responseTo: 40,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"access_token":"W6fPN3q48ZyTtjYKhv8MwS5rDh5fUIsc","name":"lancer88888","account":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547653456,"nbf":1547653456,"exp":1547653460,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.166","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1547653456,"exp":1547653460,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888","user_name":"lancer88888","full_name":"lancer88888","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJXNmZQTjNxNDhaeVR0allLaHY4TXdTNXJEaDVmVUlzYyIsIm5hbWUiOiJsYW5jZXI4ODg4OCIsImFjY291bnQiOiJsYW5jZXI4ODg4OCIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzY1MzQ1NiwibmJmIjoxNTQ3NjUzNDU2LCJleHAiOjE1NDc2NTM0NjAsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.lKubfyHdiGnmGBi5v5-jTonDpXP1Pj1niBaQZgjJC53I38Zfw540L3gKO8TARGZEITB7V4NFe6VmtPuKSWM6XzmgqTHZGBEK7E3JyOdJqkyT9P2b-Hp-MivGSkFWIzVNU9eQctoHdadmnlXNVNf2UzVFx_a7bHk9bPf3EVVbgkGmzcBE08zaifURbi7gMweq9O_eHz80sdMaHgW59CZapUxupn1Z0gUdnFHQMVclfI18ignQ0hpk9Zk62tZDsYb-yN6oZ9jM0lQdVliimfZZM1-nQ8HF1lOTubK_4rA__MXDMQhhpetal2717llWGn8SN91TyYSnof3JyVHKXEDq_Q"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJXNmZQTjNxNDhaeVR0allLaHY4TXdTNXJEaDVmVUlzYyIsIm5hbWUiOiJsYW5jZXI4ODg4OCIsImFjY291bnQiOiJsYW5jZXI4ODg4OCIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzY1MzQ1NiwibmJmIjoxNTQ3NjUzNDU2LCJleHAiOjE1NDc2NTM0NjAsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.lKubfyHdiGnmGBi5v5-jTonDpXP1Pj1niBaQZgjJC53I38Zfw540L3gKO8TARGZEITB7V4NFe6VmtPuKSWM6XzmgqTHZGBEK7E3JyOdJqkyT9P2b-Hp-MivGSkFWIzVNU9eQctoHdadmnlXNVNf2UzVFx_a7bHk9bPf3EVVbgkGmzcBE08zaifURbi7gMweq9O_eHz80sdMaHgW59CZapUxupn1Z0gUdnFHQMVclfI18ignQ0hpk9Zk62tZDsYb-yN6oZ9jM0lQdVliimfZZM1-nQ8HF1lOTubK_4rA__MXDMQhhpetal2717llWGn8SN91TyYSnof3JyVHKXEDq_Q","osVersion":"Win 10.0.16299.15","displayVersion":"1.0.27","platform":"Windows 10 UWP Build(x64)","skin":"blue"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  skin: 'blue' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 23,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 933,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 14346,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 983,
           [Symbol(triggerId)]: 933 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b8 e5 11 03 50 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51504568,
     responseTo: 80,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入getuserguid方法
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
action: getuserguid  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
registerUserGuid----"asdayryt"
registerUserGuid------------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
=========================={"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}======================
action: getuserguid-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
queryUserRole连接成功
queryUserRole连接成功"teacher"
insertEntity数据库地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359/UserGuid
连接数据库成功
连接数据库成功


> Eric@1.0.0 start /opt/server
> node js/server.js

getUserTableSettings: EnvironemtType:3
Using local emulator
getUserTableSettings: EnvironemtType:3
getUserTableSettings: EnvironemtType:3
查看下当前的环境：  false
Express start on port 1337...
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"lancer88888","trialsAllowed":"22","trialsUsed":"3"}
eeeewwwwww
看一下这个data：{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入user
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  trialsAllowed: 22,
  trialsUsed: 3 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 15,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 558,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 16257,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 607,
           [Symbol(triggerId)]: 558 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 3a 01 12 03 35 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51511610,
     responseTo: 53,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":22,"trialsUsed":3}
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"lancer88888","trialsAllowed":"20","trialsUsed":"1"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":22,"trialsUsed":3}
进入user
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":22,"trialsUsed":3}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  trialsAllowed: 20,
  trialsUsed: 1 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 35,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 1591,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 139794,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 1640,
           [Symbol(triggerId)]: 1591 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 82 05 12 03 8f 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51512706,
     responseTo: 143,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1}
进入getuserguid方法
base64Decoded========{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"access_token":"yNEz6kJ11Z3xvupDtM6Q36UOFf1uMhIH","name":"test190117","account":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547705164,"nbf":1547705164,"exp":1547705168,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.168","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
action: getuserguid  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","ipAddress":"111.12.1.1"}
eeeewwwwww
registerUserGuid----"111.12.1.1"
registerUserGuid------------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ"}
=========================={"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ"}======================
action: getuserguid-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJhY2Nlc3NfdG9rZW4iOiJ5TkV6NmtKMTFaM3h2dXBEdE02UTM2VU9GZjF1TWhJSCIsIm5hbWUiOiJ0ZXN0MTkwMTE3IiwiYWNjb3VudCI6InRlc3QxOTAxMTciLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc3MDUxNjQsIm5iZiI6MTU0NzcwNTE2NCwiZXhwIjoxNTQ3NzA1MTY4LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIxLjExOS4xMzIuMTY4Iiwib2lkIjoiM2NhNGI3NmJhMThiNDM2MGIwOTcxODkwNTljYWI0ZTMiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoidGVzdDE5MDExNyIsInVwbiI6InRlc3QxOTAxMTciLCJ1dGkiOiJSNzRORmhmZDBFV1g5d1RQaGFRTEFBIiwidmVyIjoiMS4wIn0.AYjdLWANElJIsJL7n4mUqRM7RweD8PbaY4eq6QpzVyLkrHx5JOHPjISkgzO-1ArM3ybs20Xn6rl-D3H3Ths_3kYylvsQKvhjHCS6bInk9hmDAFOM0nm11j32905xs4qezvLY33YL723OenQslT_j6DQ-zPTu0QC8ZfdzCBiSjMt0TmO7Ro5RFaI_WMwJmswcor-0GCAU6Gsflueeh7hrTH6mhMno5YebL0xkp2FS0s0GXFySJEgZzM5csVpqN932T3DC0X7k_Q55hLXlKB0Ov3qOcO4rDMiL8oCppTtz14Wk6FK0s01kT_5zJ9CjKmB5BWoY8Skb6Y_gYdkth0xlMQ","ipAddress":"111.12.1.1"}
eeeewwwwww
(node:13217) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
连接数据库成功
queryUserRole连接成功
queryUserRole连接成功"teacher"
insertEntity数据库地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359/UserGuid
连接数据库成功

action: getUserInfo  tenantId:   unique_name:  details: {"message":"test190117"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}
action: getUserInfo  tenantId:   unique_name:  details: {"message":"test190117"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}
action: deleteUser  tenantId:   unique_name:  details: {"message":"test0117"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: deleteUser  tenantId:   unique_name:  details: {"message":"test190117"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}

base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjAyNDIsIm5iZiI6MTU0ODE2MDI0MiwiZXhwIjoxNTQ4MTY0MTQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.IYoyatI8XS7h_XEC0mymyuaHtZXEnFHhFQ-3crinXwrw4-MCMXSd_6AMRdw9iF66aHBoer_Lowbrqz_95Po4ho89RsK-AKRE97eyKOsvPyWA-egDuq4ODHUDpWN878llPcVc4TG22rvQPkVmqMm8Q2tLy2w7Y4NpLPewXoT7Av5sguAfF8ASyIpI_asx9BrKUEBRYXUtbTbCJV6NBrVsmKxCeqgf-fSIncBYTp24n3ri4F-OsvGKxJnHEkOZtyvdYo41f3wJZHV-nj3Uy7LVMjGCthVqwKESnEVhHJ3vZ9vs8X1lLt-AhFxPSJg9Yi5nYE-9EGwOIWrcovz9nCoLGQ","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjAyNDIsIm5iZiI6MTU0ODE2MDI0MiwiZXhwIjoxNTQ4MTY0MTQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.IYoyatI8XS7h_XEC0mymyuaHtZXEnFHhFQ-3crinXwrw4-MCMXSd_6AMRdw9iF66aHBoer_Lowbrqz_95Po4ho89RsK-AKRE97eyKOsvPyWA-egDuq4ODHUDpWN878llPcVc4TG22rvQPkVmqMm8Q2tLy2w7Y4NpLPewXoT7Av5sguAfF8ASyIpI_asx9BrKUEBRYXUtbTbCJV6NBrVsmKxCeqgf-fSIncBYTp24n3ri4F-OsvGKxJnHEkOZtyvdYo41f3wJZHV-nj3Uy7LVMjGCthVqwKESnEVhHJ3vZ9vs8X1lLt-AhFxPSJg9Yi5nYE-9EGwOIWrcovz9nCoLGQ","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1}
userEntity------{"entity":{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T10:46:58.071Z","lastLicenseCheck":"2019-01-22T10:46:58.071Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1},"exists":true}
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '0e943d1a-fda9-41f7-a9ec-26c051194e4c',
  skin: 'blue',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: false }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '0e943d1a-fda9-41f7-a9ec-26c051194e4c',
  skin: 'blue',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: false }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 105,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 30339,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 3941438,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 30413,
           [Symbol(triggerId)]: 30339 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b2 8b 12 03 4d 0d 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51547058,
     responseTo: 3405,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 107,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 30364,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 3941440,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 30454,
           [Symbol(triggerId)]: 30364 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b8 8b 12 03 52 0d 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51547064,
     responseTo: 3410,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:30:38.234Z|6ded29abb67176d7196af97657b87397909c9c8ad98400a3585ceab3fe58b9bc88bb332201702125f897922c57d677a6610d95e3e8a9fc49a9fcd4dc0af6a642d20cc7f9d5a42ef6743488d0bf9d92302618fd1a9a59eadf65f7385d15b550ed329c09f551be0594eb373cf77f4ec23b99f964640224294a041174dea6f54a4ae52e78045a29df174b018ceb0af3bf5b74942444fe2fcdb2b84310947b053e7ed4d4cf632f463362c91df53f5b312e760e3bbde89cd1fb339efed296b50f31c9048fdaf395d7e82f5a5866dc53b47258a8abecf4152f0a6ed6ac533294499ae728b468b3d7db55bcab0f29b7e5f2c3898c83f249c8211f9379be491aedcf2fca
user--------111{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1}
userid--------111"0e943d1a-fda9-41f7-a9ec-26c051194e4c"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"blue","oid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:30:38.234Z|6ded29abb67176d7196af97657b87397909c9c8ad98400a3585ceab3fe58b9bc88bb332201702125f897922c57d677a6610d95e3e8a9fc49a9fcd4dc0af6a642d20cc7f9d5a42ef6743488d0bf9d92302618fd1a9a59eadf65f7385d15b550ed329c09f551be0594eb373cf77f4ec23b99f964640224294a041174dea6f54a4ae52e78045a29df174b018ceb0af3bf5b74942444fe2fcdb2b84310947b053e7ed4d4cf632f463362c91df53f5b312e760e3bbde89cd1fb339efed296b50f31c9048fdaf395d7e82f5a5866dc53b47258a8abecf4152f0a6ed6ac533294499ae728b468b3d7db55bcab0f29b7e5f2c3898c83f249c8211f9379be491aedcf2fca","clientSettings":""}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"blue\",\"oid\":\"0e943d1a-fda9-41f7-a9ec-26c051194e4c\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:30:38.234Z|6ded29abb67176d7196af97657b87397909c9c8ad98400a3585ceab3fe58b9bc88bb332201702125f897922c57d677a6610d95e3e8a9fc49a9fcd4dc0af6a642d20cc7f9d5a42ef6743488d0bf9d92302618fd1a9a59eadf65f7385d15b550ed329c09f551be0594eb373cf77f4ec23b99f964640224294a041174dea6f54a4ae52e78045a29df174b018ceb0af3bf5b74942444fe2fcdb2b84310947b053e7ed4d4cf632f463362c91df53f5b312e760e3bbde89cd1fb339efed296b50f31c9048fdaf395d7e82f5a5866dc53b47258a8abecf4152f0a6ed6ac533294499ae728b468b3d7db55bcab0f29b7e5f2c3898c83f249c8211f9379be491aedcf2fca\",\"clientSettings\":\"\",\"acceptedEula\":false}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"blue","oid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:30:38.234Z|6ded29abb67176d7196af97657b87397909c9c8ad98400a3585ceab3fe58b9bc88bb332201702125f897922c57d677a6610d95e3e8a9fc49a9fcd4dc0af6a642d20cc7f9d5a42ef6743488d0bf9d92302618fd1a9a59eadf65f7385d15b550ed329c09f551be0594eb373cf77f4ec23b99f964640224294a041174dea6f54a4ae52e78045a29df174b018ceb0af3bf5b74942444fe2fcdb2b84310947b053e7ed4d4cf632f463362c91df53f5b312e760e3bbde89cd1fb339efed296b50f31c9048fdaf395d7e82f5a5866dc53b47258a8abecf4152f0a6ed6ac533294499ae728b468b3d7db55bcab0f29b7e5f2c3898c83f249c8211f9379be491aedcf2fca","clientSettings":"","acceptedEula":false}
进入eula方法
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548160242,"nbf":1548160242,"exp":1548164142,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjAyNDIsIm5iZiI6MTU0ODE2MDI0MiwiZXhwIjoxNTQ4MTY0MTQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.IYoyatI8XS7h_XEC0mymyuaHtZXEnFHhFQ-3crinXwrw4-MCMXSd_6AMRdw9iF66aHBoer_Lowbrqz_95Po4ho89RsK-AKRE97eyKOsvPyWA-egDuq4ODHUDpWN878llPcVc4TG22rvQPkVmqMm8Q2tLy2w7Y4NpLPewXoT7Av5sguAfF8ASyIpI_asx9BrKUEBRYXUtbTbCJV6NBrVsmKxCeqgf-fSIncBYTp24n3ri4F-OsvGKxJnHEkOZtyvdYo41f3wJZHV-nj3Uy7LVMjGCthVqwKESnEVhHJ3vZ9vs8X1lLt-AhFxPSJg9Yi5nYE-9EGwOIWrcovz9nCoLGQ","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjAyNDIsIm5iZiI6MTU0ODE2MDI0MiwiZXhwIjoxNTQ4MTY0MTQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.IYoyatI8XS7h_XEC0mymyuaHtZXEnFHhFQ-3crinXwrw4-MCMXSd_6AMRdw9iF66aHBoer_Lowbrqz_95Po4ho89RsK-AKRE97eyKOsvPyWA-egDuq4ODHUDpWN878llPcVc4TG22rvQPkVmqMm8Q2tLy2w7Y4NpLPewXoT7Av5sguAfF8ASyIpI_asx9BrKUEBRYXUtbTbCJV6NBrVsmKxCeqgf-fSIncBYTp24n3ri4F-OsvGKxJnHEkOZtyvdYo41f3wJZHV-nj3Uy7LVMjGCthVqwKESnEVhHJ3vZ9vs8X1lLt-AhFxPSJg9Yi5nYE-9EGwOIWrcovz9nCoLGQ","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c46f4a2f2246f6ef9afe6c6","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"0e943d1a-fda9-41f7-a9ec-26c051194e4c","skin":"blue","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":20,"trialsUsed":1}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 123,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 31126,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 3945218,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 31175,
           [Symbol(triggerId)]: 31126 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 16 8c 12 03 89 0d 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51547158,
     responseTo: 3465,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+null
userEntity------{"entity":null,"exists":false}
isExistingUser-------false
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":null,"exists":false}
-----getUserRoleRisky----111111
roleteacher
isExistingUser222
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-22T12:44:34.517Z,
  lastLicenseCheck: 2019-01-22T12:44:34.517Z,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
  skin: 'EduSkins_Alex',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: false,
  trialsAllowed: 25 }
insertOrMerge插入数据
CommandResult {
  result:
   { n: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 139,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 43152,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4777739,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 43201,
           [Symbol(triggerId)]: 43152 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 78 00 00 00 53 ac 12 03 f2 12 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 54 69 6d 65 00 1c 00 00 00 11 74 73 00 07 00 00 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 120,
     requestId: 51555411,
     responseTo: 4850,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 104,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  ops:
   [ { tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
       unique_name: 'lancer88888',
       lastRoleCheck: 2019-01-22T12:44:34.517Z,
       lastLicenseCheck: 2019-01-22T12:44:34.517Z,
       role: 'teacher',
       name: 'lancer88888',
       oid: '575bd4e8421b458ea8cc42b20fb0b73b',
       anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
       skin: 'EduSkins_Alex',
       nickname: 'lancer88888',
       isLicensed: true,
       licenseType: undefined,
       acceptedEula: false,
       trialsAllowed: 25,
       _id: 5c4710322d9d6633a1bc9d36 } ],
  insertedCount: 1,
  insertedId: 5c4710322d9d6633a1bc9d36 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:34.533Z|60b1a18c085814785f4fcc0305536d5127ffbe387e4479dbd7781d90ddf0a3ce368c524cc464bdd1c7c00cf44ae5cf0048e0d75d7a06b11fe9322db832c69194cb73560595906210a7ad8a6b561fa7a71dd53a27108fe807428697bd229225cb55ae360a6d32eb783f1a1a3f0a594de15b8de090e7775c0563b27b56b2f2ce636892a570df63e43574230a5d7175d55db25a6bf3b52c9bda7758c07ac237e431844d079d0ee47aca94e7b6d0c8338fbf8b94009158e1d48cebd3fdc238f5be0147461ea7506ad23872d5393381fbeda54d6eb2c872d77db4a2480f18137c09e50aaf03fd06e0cd2e5339f689a81904d0fcc6f70efd7af1873883ab7701c84398
user--------111{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"acceptedEula":false,"trialsAllowed":25,"_id":"5c4710322d9d6633a1bc9d36"}
userid--------111"33450d04-7fe4-4aa1-adad-e2bc23fe60cb"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:34.533Z|60b1a18c085814785f4fcc0305536d5127ffbe387e4479dbd7781d90ddf0a3ce368c524cc464bdd1c7c00cf44ae5cf0048e0d75d7a06b11fe9322db832c69194cb73560595906210a7ad8a6b561fa7a71dd53a27108fe807428697bd229225cb55ae360a6d32eb783f1a1a3f0a594de15b8de090e7775c0563b27b56b2f2ce636892a570df63e43574230a5d7175d55db25a6bf3b52c9bda7758c07ac237e431844d079d0ee47aca94e7b6d0c8338fbf8b94009158e1d48cebd3fdc238f5be0147461ea7506ad23872d5393381fbeda54d6eb2c872d77db4a2480f18137c09e50aaf03fd06e0cd2e5339f689a81904d0fcc6f70efd7af1873883ab7701c84398","clientSettings":""}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":true,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"EduSkins_Alex\",\"oid\":\"33450d04-7fe4-4aa1-adad-e2bc23fe60cb\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:34.533Z|60b1a18c085814785f4fcc0305536d5127ffbe387e4479dbd7781d90ddf0a3ce368c524cc464bdd1c7c00cf44ae5cf0048e0d75d7a06b11fe9322db832c69194cb73560595906210a7ad8a6b561fa7a71dd53a27108fe807428697bd229225cb55ae360a6d32eb783f1a1a3f0a594de15b8de090e7775c0563b27b56b2f2ce636892a570df63e43574230a5d7175d55db25a6bf3b52c9bda7758c07ac237e431844d079d0ee47aca94e7b6d0c8338fbf8b94009158e1d48cebd3fdc238f5be0147461ea7506ad23872d5393381fbeda54d6eb2c872d77db4a2480f18137c09e50aaf03fd06e0cd2e5339f689a81904d0fcc6f70efd7af1873883ab7701c84398\",\"clientSettings\":\"\",\"acceptedEula\":false}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:34.533Z|60b1a18c085814785f4fcc0305536d5127ffbe387e4479dbd7781d90ddf0a3ce368c524cc464bdd1c7c00cf44ae5cf0048e0d75d7a06b11fe9322db832c69194cb73560595906210a7ad8a6b561fa7a71dd53a27108fe807428697bd229225cb55ae360a6d32eb783f1a1a3f0a594de15b8de090e7775c0563b27b56b2f2ce636892a570df63e43574230a5d7175d55db25a6bf3b52c9bda7758c07ac237e431844d079d0ee47aca94e7b6d0c8338fbf8b94009158e1d48cebd3fdc238f5be0147461ea7506ad23872d5393381fbeda54d6eb2c872d77db4a2480f18137c09e50aaf03fd06e0cd2e5339f689a81904d0fcc6f70efd7af1873883ab7701c84398","clientSettings":"","acceptedEula":false}
进入eula方法
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
连接数据库成功
final+{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 155,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 43884,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4780600,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 43933,
           [Symbol(triggerId)]: 43884 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 bb ac 12 03 2f 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555515,
     responseTo: 4911,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161079,"nbf":1548161079,"exp":1548164979,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1548161079,"exp":1548164979,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888","user_name":"lancer88888","full_name":"lancer88888","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEwNzksIm5iZiI6MTU0ODE2MTA3OSwiZXhwIjoxNTQ4MTY0OTc5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.e8vxagkzEnwz9qGzmkKl7S6zwZX-ufRzPwpSe2EnYS04xUxYWFpyKXolqTcuUX1qUHyN_9dhrCoNpkSgRTby1b7AW6_92-YU79SqoKHr8MmW6UvmS4TmlYS9RsYUEzRsEffsj-GKpWBFb7GYMTXEt__EimYcJTiBARvCBm815zRxidayBPij9o1esPiCPaqlj5Z6AMKjC3NsMC3XXkAcU1DE3KaNtiOGh2Q8YvmLKZXa2uF8uJ1WX78oPfbx0-KZxgPelFZVNr3B1mUJaXaIbviDUD7nWArR1WU7AFnu4cub9hYvqSJ3gSEIfl6EdWKcmDEmuOghDxz_oaA89wqf7A","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 167,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 44411,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4786105,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 44460,
           [Symbol(triggerId)]: 44411 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 1f ad 12 03 5b 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555615,
     responseTo: 4955,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc4ODIxODAsIm5iZiI6MTU0Nzg4MjE4MCwiZXhwIjoxNTQ3ODg2MDgwLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.Sqho-lbVuGCU8uR4eb45MmfmylwxeGUeAsq5ZUfeZrrQV-kxCQEisn0kv5gVV-mewGbHF8Ii5esm_VvB2ouY2gURNHOcxo9Hb333sgj66d_IRMbyQYUaOx0Hr4dx13DP-HNsCBTmU5wjC8N0WhyJ1eTXTVJ0s_-frASOE1C8m1SgaK0eCVqaeIEcD2MsgOOSRpoJnMBtkoUqbLcLtsoz_oRfj2R6VFi0CJfT57HG53PyYAuE00a_7Dtz0yOMP0VetrtNgvTdGjz1DJW-q_j7UqJ1GRl-avj3PZtFOgtWJ29nUWYmACibuiXwAXWOWB-1BOIPcVsZjS7A0MNfTAldAg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc4ODIxODAsIm5iZiI6MTU0Nzg4MjE4MCwiZXhwIjoxNTQ3ODg2MDgwLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.Sqho-lbVuGCU8uR4eb45MmfmylwxeGUeAsq5ZUfeZrrQV-kxCQEisn0kv5gVV-mewGbHF8Ii5esm_VvB2ouY2gURNHOcxo9Hb333sgj66d_IRMbyQYUaOx0Hr4dx13DP-HNsCBTmU5wjC8N0WhyJ1eTXTVJ0s_-frASOE1C8m1SgaK0eCVqaeIEcD2MsgOOSRpoJnMBtkoUqbLcLtsoz_oRfj2R6VFi0CJfT57HG53PyYAuE00a_7Dtz0yOMP0VetrtNgvTdGjz1DJW-q_j7UqJ1GRl-avj3PZtFOgtWJ29nUWYmACibuiXwAXWOWB-1BOIPcVsZjS7A0MNfTAldAg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25}
userEntity------{"entity":{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:34.517Z","lastLicenseCheck":"2019-01-22T12:44:34.517Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 181,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 45082,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4790525,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 45151,
           [Symbol(triggerId)]: 45082 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 81 ad 12 03 97 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555713,
     responseTo: 5015,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 183,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 45107,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4790527,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 45215,
           [Symbol(triggerId)]: 45107 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 86 ad 12 03 9d 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555718,
     responseTo: 5021,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:47.321Z|020b37b3bf80e81fc7a95c59d32324de33a5ff93ead7a6dd6767e033345f16b34b685ff328eaacfba9d93d8d745ad4b043ab4bbed977a6d9a75c82dee5d778db60252672780bba72226f43afcc0d31f3fba517e6678f132f21e6a1f4192567fd5a537710509d8371b17a3e1d727943166a9088f23773d5757acd4df6658a96a07ce545860a9a97d29113e5e30c8cf3d6a56ffb28129c68d0fe7f69cd1ff5c5ee49955aaf057e1c55a919e70b79e08178ccd5a70051a8a304e549b66363a3c7e9c0a5a079de8a07d5650b02139c70e7ce3d6fe7726f50ad992873e595df41034e81e69893f0f4820921ca6faf910d41c0f860e8f6e745c87f14da783438800c58
user--------111{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"acceptedEula":true,"trialsAllowed":25}
userid--------111"33450d04-7fe4-4aa1-adad-e2bc23fe60cb"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:47.321Z|020b37b3bf80e81fc7a95c59d32324de33a5ff93ead7a6dd6767e033345f16b34b685ff328eaacfba9d93d8d745ad4b043ab4bbed977a6d9a75c82dee5d778db60252672780bba72226f43afcc0d31f3fba517e6678f132f21e6a1f4192567fd5a537710509d8371b17a3e1d727943166a9088f23773d5757acd4df6658a96a07ce545860a9a97d29113e5e30c8cf3d6a56ffb28129c68d0fe7f69cd1ff5c5ee49955aaf057e1c55a919e70b79e08178ccd5a70051a8a304e549b66363a3c7e9c0a5a079de8a07d5650b02139c70e7ce3d6fe7726f50ad992873e595df41034e81e69893f0f4820921ca6faf910d41c0f860e8f6e745c87f14da783438800c58","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve\",\"oid\":\"33450d04-7fe4-4aa1-adad-e2bc23fe60cb\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:47.321Z|020b37b3bf80e81fc7a95c59d32324de33a5ff93ead7a6dd6767e033345f16b34b685ff328eaacfba9d93d8d745ad4b043ab4bbed977a6d9a75c82dee5d778db60252672780bba72226f43afcc0d31f3fba517e6678f132f21e6a1f4192567fd5a537710509d8371b17a3e1d727943166a9088f23773d5757acd4df6658a96a07ce545860a9a97d29113e5e30c8cf3d6a56ffb28129c68d0fe7f69cd1ff5c5ee49955aaf057e1c55a919e70b79e08178ccd5a70051a8a304e549b66363a3c7e9c0a5a079de8a07d5650b02139c70e7ce3d6fe7726f50ad992873e595df41034e81e69893f0f4820921ca6faf910d41c0f860e8f6e745c87f14da783438800c58\",\"clientSettings\":\"\",\"popup\":{\"id\":\"5c466b18-7982-4b90-9a20-94901f33c2b7\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \\\"C\\\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"},\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:47.321Z|020b37b3bf80e81fc7a95c59d32324de33a5ff93ead7a6dd6767e033345f16b34b685ff328eaacfba9d93d8d745ad4b043ab4bbed977a6d9a75c82dee5d778db60252672780bba72226f43afcc0d31f3fba517e6678f132f21e6a1f4192567fd5a537710509d8371b17a3e1d727943166a9088f23773d5757acd4df6658a96a07ce545860a9a97d29113e5e30c8cf3d6a56ffb28129c68d0fe7f69cd1ff5c5ee49955aaf057e1c55a919e70b79e08178ccd5a70051a8a304e549b66363a3c7e9c0a5a079de8a07d5650b02139c70e7ce3d6fe7726f50ad992873e595df41034e81e69893f0f4820921ca6faf910d41c0f860e8f6e745c87f14da783438800c58","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"},"acceptedEula":true}
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547882180,"nbf":1547882180,"exp":1547886080,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"73.225.99.122","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc4ODIxODAsIm5iZiI6MTU0Nzg4MjE4MCwiZXhwIjoxNTQ3ODg2MDgwLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.Sqho-lbVuGCU8uR4eb45MmfmylwxeGUeAsq5ZUfeZrrQV-kxCQEisn0kv5gVV-mewGbHF8Ii5esm_VvB2ouY2gURNHOcxo9Hb333sgj66d_IRMbyQYUaOx0Hr4dx13DP-HNsCBTmU5wjC8N0WhyJ1eTXTVJ0s_-frASOE1C8m1SgaK0eCVqaeIEcD2MsgOOSRpoJnMBtkoUqbLcLtsoz_oRfj2R6VFi0CJfT57HG53PyYAuE00a_7Dtz0yOMP0VetrtNgvTdGjz1DJW-q_j7UqJ1GRl-avj3PZtFOgtWJ29nUWYmACibuiXwAXWOWB-1BOIPcVsZjS7A0MNfTAldAg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDc4ODIxODAsIm5iZiI6MTU0Nzg4MjE4MCwiZXhwIjoxNTQ3ODg2MDgwLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiI3My4yMjUuOTkuMTIyIiwib2lkIjoiNTc1YmQ0ZTg0MjFiNDU4ZWE4Y2M0MmIyMGZiMGI3M2IiLCJwdWlkIjoiMTAwMzdGRkU5OTk1QUQ2OSIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Im1lZUBqZGNsb3VkLmNvbSIsInRpZCI6IjM4ZGQ2NjM0LTE5MzEtNGM1MC1hOWI0LWQxNmNkOWQ5N2Q1NyIsInVuaXF1ZV9uYW1lIjoibGFuY2VyODg4ODgiLCJ1cG4iOiJsYW5jZXI4ODg4OCIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.Sqho-lbVuGCU8uR4eb45MmfmylwxeGUeAsq5ZUfeZrrQV-kxCQEisn0kv5gVV-mewGbHF8Ii5esm_VvB2ouY2gURNHOcxo9Hb333sgj66d_IRMbyQYUaOx0Hr4dx13DP-HNsCBTmU5wjC8N0WhyJ1eTXTVJ0s_-frASOE1C8m1SgaK0eCVqaeIEcD2MsgOOSRpoJnMBtkoUqbLcLtsoz_oRfj2R6VFi0CJfT57HG53PyYAuE00a_7Dtz0yOMP0VetrtNgvTdGjz1DJW-q_j7UqJ1GRl-avj3PZtFOgtWJ29nUWYmACibuiXwAXWOWB-1BOIPcVsZjS7A0MNfTAldAg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25}
userEntity------{"entity":{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
-----getUserRoleRisky----111111
roleteacher
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-22T12:44:49.584Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-22T12:44:49.584Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '33450d04-7fe4-4aa1-adad-e2bc23fe60cb',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 207,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 46101,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4792807,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 46200,
           [Symbol(triggerId)]: 46101 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 d9 ad 12 03 ef 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555801,
     responseTo: 5103,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 205,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 46093,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 4792807,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 46194,
           [Symbol(triggerId)]: 46093 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 db ad 12 03 ee 13 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51555803,
     responseTo: 5102,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:49.601Z|85e458a860b1808ab6ee938b50dfaa025d0143d854a407d0082706b5e71d99d634e0f89a5e71eac03339f78c64fcdb5eec831689dfd61b44f7ef11404686e7392dce6b36db48f149a8906e84a8c63adbb8521d7f5d577a9daf6bff67559824280e0d986f440cf5a6a134bac3fd7e7ab5c70b9f18a2d97d6d6f30c7771c7a255cecbc2873f0ef29ac4dacb15d039fb7f94c9d8bb02d1ea6d7412c47bdeb234fe24a4e37686bc6393e060b0d6fec019fa8b433ba6f5044eac2ffa97d112c5c2a1d30047485e44f63ec3900241b1403b92999472175db45b1501b7bd0a2e07c9c407b8b889122fe774b9a363984e9fdfbd98fba44403b743ff07db94e5815c7c2e0
user--------111{"_id":"5c4710322d9d6633a1bc9d36","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:44:49.584Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","nickname":"lancer88888","isLicensed":true,"acceptedEula":true,"trialsAllowed":25}
userid--------111"33450d04-7fe4-4aa1-adad-e2bc23fe60cb"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:49.601Z|85e458a860b1808ab6ee938b50dfaa025d0143d854a407d0082706b5e71d99d634e0f89a5e71eac03339f78c64fcdb5eec831689dfd61b44f7ef11404686e7392dce6b36db48f149a8906e84a8c63adbb8521d7f5d577a9daf6bff67559824280e0d986f440cf5a6a134bac3fd7e7ab5c70b9f18a2d97d6d6f30c7771c7a255cecbc2873f0ef29ac4dacb15d039fb7f94c9d8bb02d1ea6d7412c47bdeb234fe24a4e37686bc6393e060b0d6fec019fa8b433ba6f5044eac2ffa97d112c5c2a1d30047485e44f63ec3900241b1403b92999472175db45b1501b7bd0a2e07c9c407b8b889122fe774b9a363984e9fdfbd98fba44403b743ff07db94e5815c7c2e0","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve\",\"oid\":\"33450d04-7fe4-4aa1-adad-e2bc23fe60cb\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:49.601Z|85e458a860b1808ab6ee938b50dfaa025d0143d854a407d0082706b5e71d99d634e0f89a5e71eac03339f78c64fcdb5eec831689dfd61b44f7ef11404686e7392dce6b36db48f149a8906e84a8c63adbb8521d7f5d577a9daf6bff67559824280e0d986f440cf5a6a134bac3fd7e7ab5c70b9f18a2d97d6d6f30c7771c7a255cecbc2873f0ef29ac4dacb15d039fb7f94c9d8bb02d1ea6d7412c47bdeb234fe24a4e37686bc6393e060b0d6fec019fa8b433ba6f5044eac2ffa97d112c5c2a1d30047485e44f63ec3900241b1403b92999472175db45b1501b7bd0a2e07c9c407b8b889122fe774b9a363984e9fdfbd98fba44403b743ff07db94e5815c7c2e0\",\"clientSettings\":\"\",\"popup\":{\"id\":\"5c466b18-7982-4b90-9a20-94901f33c2b7\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \\\"C\\\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"},\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Steve","oid":"33450d04-7fe4-4aa1-adad-e2bc23fe60cb","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:44:49.601Z|85e458a860b1808ab6ee938b50dfaa025d0143d854a407d0082706b5e71d99d634e0f89a5e71eac03339f78c64fcdb5eec831689dfd61b44f7ef11404686e7392dce6b36db48f149a8906e84a8c63adbb8521d7f5d577a9daf6bff67559824280e0d986f440cf5a6a134bac3fd7e7ab5c70b9f18a2d97d6d6f30c7771c7a255cecbc2873f0ef29ac4dacb15d039fb7f94c9d8bb02d1ea6d7412c47bdeb234fe24a4e37686bc6393e060b0d6fec019fa8b433ba6f5044eac2ffa97d112c5c2a1d30047485e44f63ec3900241b1403b92999472175db45b1501b7bd0a2e07c9c407b8b889122fe774b9a363984e9fdfbd98fba44403b743ff07db94e5815c7c2e0","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"},"acceptedEula":true}
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+null
userEntity------{"entity":null,"exists":false}
isExistingUser-------false
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":null,"exists":false}
-----getUserRoleRisky----111111
roleteacher
isExistingUser222
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-22T12:48:58.173Z,
  lastLicenseCheck: 2019-01-22T12:48:58.173Z,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '3dcd7d69-9e37-4015-8341-3331cf3ef9d0',
  skin: 'EduSkins_Alex',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: false,
  trialsAllowed: 25 }
insertOrMerge插入数据
CommandResult {
  result:
   { n: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 227,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 50452,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 5041393,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 50501,
           [Symbol(triggerId)]: 50452 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 78 00 00 00 1d b8 12 03 c1 15 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 54 69 6d 65 00 1c 00 00 00 11 74 73 00 03 00 00 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 120,
     requestId: 51558429,
     responseTo: 5569,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 104,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  ops:
   [ { tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
       unique_name: 'lancer88888',
       lastRoleCheck: 2019-01-22T12:48:58.173Z,
       lastLicenseCheck: 2019-01-22T12:48:58.173Z,
       role: 'teacher',
       name: 'lancer88888',
       oid: '575bd4e8421b458ea8cc42b20fb0b73b',
       anonimizedOid: '3dcd7d69-9e37-4015-8341-3331cf3ef9d0',
       skin: 'EduSkins_Alex',
       nickname: 'lancer88888',
       isLicensed: true,
       licenseType: undefined,
       acceptedEula: false,
       trialsAllowed: 25,
       _id: 5c47113a2d9d6633a1bc9d3f } ],
  insertedCount: 1,
  insertedId: 5c47113a2d9d6633a1bc9d3f }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:48:58.186Z|0118511a90d32641a7bb64d3c98c0d945138b7ecba798d5184fbebe414bbbf72a0ec910835920cc90bf4db22cdf07e468c74fc1661b2e0b01f789a6c4ce5675e6c408eb5557077e76a43e57f04daf5dd9f5caa4a8b2ec9cdf85c6965166c735b92d232f2d81bf8fb9f7105954daaece2a73675373aead3e713f2f51594cb99a1691b2b4abcdd0a81832607d4d3f13c2d88ae3d66582257cebb2f468c1a116118aa0f20cfbf06fef941b13317ff014b37e9810af2a98b4347f6dbfc1ba8cf0e12fd93b6fe8626fd55fb6e6fbd4055f52de53619d29c7fa24cbd8477f9def4970f9f9a5a7aafc70c784919e60f6731d22edb691c617d63f2592343e1b6afab8f56
user--------111{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"acceptedEula":false,"trialsAllowed":25,"_id":"5c47113a2d9d6633a1bc9d3f"}
userid--------111"3dcd7d69-9e37-4015-8341-3331cf3ef9d0"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:48:58.186Z|0118511a90d32641a7bb64d3c98c0d945138b7ecba798d5184fbebe414bbbf72a0ec910835920cc90bf4db22cdf07e468c74fc1661b2e0b01f789a6c4ce5675e6c408eb5557077e76a43e57f04daf5dd9f5caa4a8b2ec9cdf85c6965166c735b92d232f2d81bf8fb9f7105954daaece2a73675373aead3e713f2f51594cb99a1691b2b4abcdd0a81832607d4d3f13c2d88ae3d66582257cebb2f468c1a116118aa0f20cfbf06fef941b13317ff014b37e9810af2a98b4347f6dbfc1ba8cf0e12fd93b6fe8626fd55fb6e6fbd4055f52de53619d29c7fa24cbd8477f9def4970f9f9a5a7aafc70c784919e60f6731d22edb691c617d63f2592343e1b6afab8f56","clientSettings":""}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":true,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"EduSkins_Alex\",\"oid\":\"3dcd7d69-9e37-4015-8341-3331cf3ef9d0\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:48:58.186Z|0118511a90d32641a7bb64d3c98c0d945138b7ecba798d5184fbebe414bbbf72a0ec910835920cc90bf4db22cdf07e468c74fc1661b2e0b01f789a6c4ce5675e6c408eb5557077e76a43e57f04daf5dd9f5caa4a8b2ec9cdf85c6965166c735b92d232f2d81bf8fb9f7105954daaece2a73675373aead3e713f2f51594cb99a1691b2b4abcdd0a81832607d4d3f13c2d88ae3d66582257cebb2f468c1a116118aa0f20cfbf06fef941b13317ff014b37e9810af2a98b4347f6dbfc1ba8cf0e12fd93b6fe8626fd55fb6e6fbd4055f52de53619d29c7fa24cbd8477f9def4970f9f9a5a7aafc70c784919e60f6731d22edb691c617d63f2592343e1b6afab8f56\",\"clientSettings\":\"\",\"acceptedEula\":false}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:48:58.186Z|0118511a90d32641a7bb64d3c98c0d945138b7ecba798d5184fbebe414bbbf72a0ec910835920cc90bf4db22cdf07e468c74fc1661b2e0b01f789a6c4ce5675e6c408eb5557077e76a43e57f04daf5dd9f5caa4a8b2ec9cdf85c6965166c735b92d232f2d81bf8fb9f7105954daaece2a73675373aead3e713f2f51594cb99a1691b2b4abcdd0a81832607d4d3f13c2d88ae3d66582257cebb2f468c1a116118aa0f20cfbf06fef941b13317ff014b37e9810af2a98b4347f6dbfc1ba8cf0e12fd93b6fe8626fd55fb6e6fbd4055f52de53619d29c7fa24cbd8477f9def4970f9f9a5a7aafc70c784919e60f6731d22edb691c617d63f2592343e1b6afab8f56","clientSettings":"","acceptedEula":false}
进入eula方法
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 243,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 51396,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 5064376,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 51445,
           [Symbol(triggerId)]: 51396 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 42 b9 12 03 16 16 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51558722,
     responseTo: 5654,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161342,"nbf":1548161342,"exp":1548165242,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1548161342,"exp":1548165242,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"575bd4e8421b458ea8cc42b20fb0b73b","unique_name":"lancer88888","user_name":"lancer88888","full_name":"lancer88888","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjEzNDIsIm5iZiI6MTU0ODE2MTM0MiwiZXhwIjoxNTQ4MTY1MjQyLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.fth-nY8Qs_La_hK_MGNf_teRZfD8tAsLHRzED8BproQsHKxwi-bEpE6EZJd-4osucEH9wztaB2q6U124r0wY6HnGKTuWYT3c0LL9N_ECDBvMGA3hq5zmDNyUg9HLxhCEKWI02tYaRYNuYf0kSGsk1zvNxmo5PUBIxG1YWLNQO_xX9FDDIqCGww0-ungLH0Sj5SYCyH4C1A8RApIrLUZ0yO3mhmQD_lOMRjZVeTuVK0DmLCWvzI43X_2lwYUwlGuEKPJOowWYw_CHgGHCyAxsOakce2EfrbB1_N_CkYAJaUC-VwwDGpeP3hYVgFnJaaovzplicIGvsJDGwWd0pl8nOg","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 255,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 52015,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 5070154,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 52064,
           [Symbol(triggerId)]: 52015 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b2 b9 12 03 4c 16 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51558834,
     responseTo: 5708,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161933,"nbf":1548161933,"exp":1548165833,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161933,"nbf":1548161933,"exp":1548165833,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548161933,"nbf":1548161933,"exp":1548165833,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjE5MzMsIm5iZiI6MTU0ODE2MTkzMywiZXhwIjoxNTQ4MTY1ODMzLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.VGJwSYF6Qgum2ORgXfkqNHUyFC2SvVOjjpTkNRsxrusIDzxiy6Yn-mCgRcgHsQ6w5kn46z-zQGedQCo6AKQpPEXKY0uJRUml6SblhvQCPeQOibePgM4lBfchxaKq8oy9lLsUttObKWsxfBLm1jdD0xLbUH1jY3NCDpDViLXY78T_xFQPl8YCcapL7CTPn9Rs2Fl_SLVzmLLHpfaSVWYFLCGGWO-iu_RaErBa2dBNGWooz6jW8XGxKlqy1bTuutxcSISNeencPiZT33G6w1Py0MMN3D6a6M5R0NmbQGNvsuw2dotuHTHWZis_2W6PbkdPI0PZD9DOBXWHLsoxdPMEWA","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjE5MzMsIm5iZiI6MTU0ODE2MTkzMywiZXhwIjoxNTQ4MTY1ODMzLCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.VGJwSYF6Qgum2ORgXfkqNHUyFC2SvVOjjpTkNRsxrusIDzxiy6Yn-mCgRcgHsQ6w5kn46z-zQGedQCo6AKQpPEXKY0uJRUml6SblhvQCPeQOibePgM4lBfchxaKq8oy9lLsUttObKWsxfBLm1jdD0xLbUH1jY3NCDpDViLXY78T_xFQPl8YCcapL7CTPn9Rs2Fl_SLVzmLLHpfaSVWYFLCGGWO-iu_RaErBa2dBNGWooz6jW8XGxKlqy1bTuutxcSISNeencPiZT33G6w1Py0MMN3D6a6M5R0NmbQGNvsuw2dotuHTHWZis_2W6PbkdPI0PZD9DOBXWHLsoxdPMEWA","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25}
userEntity------{"entity":{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T12:48:58.173Z","lastLicenseCheck":"2019-01-22T12:48:58.173Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":true,"trialsAllowed":25},"exists":true}
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '3dcd7d69-9e37-4015-8341-3331cf3ef9d0',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '3dcd7d69-9e37-4015-8341-3331cf3ef9d0',
  skin: 'c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 269,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 60234,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 5632321,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 60335,
           [Symbol(triggerId)]: 60234 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 ad cf 12 03 04 1a 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51564461,
     responseTo: 6660,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 271,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 60242,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 5632322,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 60341,
           [Symbol(triggerId)]: 60242 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 ae cf 12 03 03 1a 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51564462,
     responseTo: 6659,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:58:49.116Z|835504aa2b4381546593826c92e1f7dd5a5d493f030f4e688e5277822be6018d80db3ef32bbaf5a62306ad9822512da9a90c4b5794245d676e09a81d722c5d03631739342058821476a8414da675b12ad052431576657d0639c1c1ec5a21a85d82dc5744fe33a80c7f0093e001e341e4d8edeff9feead4a38cc1d886b8fbae55733fce5b3bb5b41b337eac954449ef7d894c0a8898556f9cff71cbcff6507fa2b2ce00f9cefd9005104f83193ed8ebb395723472a75f2b2300783657ac4e450e764a657236e1e23471b7a9eb332b73b4213015ed8ed125e94a870c5d962c547ad84cac051939670c4927b65a2bc1dbbb608886edccf43678b39afa6cc3b2f2a5
user--------111{"_id":"5c47113a2d9d6633a1bc9d3f","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","nickname":"lancer88888","isLicensed":true,"acceptedEula":true,"trialsAllowed":25}
userid--------111"3dcd7d69-9e37-4015-8341-3331cf3ef9d0"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","oid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:58:49.116Z|835504aa2b4381546593826c92e1f7dd5a5d493f030f4e688e5277822be6018d80db3ef32bbaf5a62306ad9822512da9a90c4b5794245d676e09a81d722c5d03631739342058821476a8414da675b12ad052431576657d0639c1c1ec5a21a85d82dc5744fe33a80c7f0093e001e341e4d8edeff9feead4a38cc1d886b8fbae55733fce5b3bb5b41b337eac954449ef7d894c0a8898556f9cff71cbcff6507fa2b2ce00f9cefd9005104f83193ed8ebb395723472a75f2b2300783657ac4e450e764a657236e1e23471b7a9eb332b73b4213015ed8ed125e94a870c5d962c547ad84cac051939670c4927b65a2bc1dbbb608886edccf43678b39afa6cc3b2f2a5","clientSettings":""}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex\",\"oid\":\"3dcd7d69-9e37-4015-8341-3331cf3ef9d0\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:58:49.116Z|835504aa2b4381546593826c92e1f7dd5a5d493f030f4e688e5277822be6018d80db3ef32bbaf5a62306ad9822512da9a90c4b5794245d676e09a81d722c5d03631739342058821476a8414da675b12ad052431576657d0639c1c1ec5a21a85d82dc5744fe33a80c7f0093e001e341e4d8edeff9feead4a38cc1d886b8fbae55733fce5b3bb5b41b337eac954449ef7d894c0a8898556f9cff71cbcff6507fa2b2ce00f9cefd9005104f83193ed8ebb395723472a75f2b2300783657ac4e450e764a657236e1e23471b7a9eb332b73b4213015ed8ed125e94a870c5d962c547ad84cac051939670c4927b65a2bc1dbbb608886edccf43678b39afa6cc3b2f2a5\",\"clientSettings\":\"\",\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"c18e65aa-7b21-4637-9b63-8ad63622ef01_Alex","oid":"3dcd7d69-9e37-4015-8341-3331cf3ef9d0","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T12:58:49.116Z|835504aa2b4381546593826c92e1f7dd5a5d493f030f4e688e5277822be6018d80db3ef32bbaf5a62306ad9822512da9a90c4b5794245d676e09a81d722c5d03631739342058821476a8414da675b12ad052431576657d0639c1c1ec5a21a85d82dc5744fe33a80c7f0093e001e341e4d8edeff9feead4a38cc1d886b8fbae55733fce5b3bb5b41b337eac954449ef7d894c0a8898556f9cff71cbcff6507fa2b2ce00f9cefd9005104f83193ed8ebb395723472a75f2b2300783657ac4e450e764a657236e1e23471b7a9eb332b73b4213015ed8ed125e94a870c5d962c547ad84cac051939670c4927b65a2bc1dbbb608886edccf43678b39afa6cc3b2f2a5","clientSettings":"","acceptedEula":true}
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所lancer88888
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjY0NDksIm5iZiI6MTU0ODE2NjQ0OSwiZXhwIjoxNTQ4MTcwMzQ5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.WGKo2N5OoaZ-y7vVjpju3OftztcN6kacLfsvWnSAf7HKsDCvHF9zzE6kaR8LynViSaNd5P0xLzcyNCELJkhMqmbGUSwiZyN3lc5Yz0zrdgRPGlTIpiG6ENiGMJCoJwBTtAzIXiPAdhMlW1AaW1Ji6xoE5qb_w8rrGkXvikaDyF46Ip4tkBWSEvOMDowjUNPsOt8nMZJLMqxm2zKwHayO-LcvdkWYhwYrNau66h73hkizZHFYNNd5pyjJbuS_7AC1z6dsx3mcUEQulMDNHkzFdkVgUyBCfMoasunjcV8F9pazFkZj1WXjhTQMNZSPgFjbMXsb5TnokLIhTvdDrlnZvw","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjY0NDksIm5iZiI6MTU0ODE2NjQ0OSwiZXhwIjoxNTQ4MTcwMzQ5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.WGKo2N5OoaZ-y7vVjpju3OftztcN6kacLfsvWnSAf7HKsDCvHF9zzE6kaR8LynViSaNd5P0xLzcyNCELJkhMqmbGUSwiZyN3lc5Yz0zrdgRPGlTIpiG6ENiGMJCoJwBTtAzIXiPAdhMlW1AaW1Ji6xoE5qb_w8rrGkXvikaDyF46Ip4tkBWSEvOMDowjUNPsOt8nMZJLMqxm2zKwHayO-LcvdkWYhwYrNau66h73hkizZHFYNNd5pyjJbuS_7AC1z6dsx3mcUEQulMDNHkzFdkVgUyBCfMoasunjcV8F9pazFkZj1WXjhTQMNZSPgFjbMXsb5TnokLIhTvdDrlnZvw","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+null
userEntity------{"entity":null,"exists":false}
isExistingUser-------false
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"entity":null,"exists":false}
-----getUserRoleRisky----111111
roleteacher
isExistingUser222
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'lancer88888',
  lastRoleCheck: 2019-01-22T14:14:04.792Z,
  lastLicenseCheck: 2019-01-22T14:14:04.792Z,
  role: 'teacher',
  name: 'lancer88888',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  anonimizedOid: '2d29c7df-5009-45bf-8997-35a4be894804',
  skin: 'EduSkins_Alex',
  nickname: 'lancer88888',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: false,
  trialsAllowed: 25 }
insertOrMerge插入数据
CommandResult {
  result:
   { n: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 291,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 122698,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 10148012,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 122747,
           [Symbol(triggerId)]: 122698 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 78 00 00 00 e7 71 13 03 7a 36 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 54 00 00 00 10 6e 00 01 00 00 00 03 6f 70 54 69 6d 65 00 1c 00 00 00 11 74 73 00 07 00 00 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 120,
     requestId: 51605991,
     responseTo: 13946,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 104,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  ops:
   [ { tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
       unique_name: 'lancer88888',
       lastRoleCheck: 2019-01-22T14:14:04.792Z,
       lastLicenseCheck: 2019-01-22T14:14:04.792Z,
       role: 'teacher',
       name: 'lancer88888',
       oid: '575bd4e8421b458ea8cc42b20fb0b73b',
       anonimizedOid: '2d29c7df-5009-45bf-8997-35a4be894804',
       skin: 'EduSkins_Alex',
       nickname: 'lancer88888',
       isLicensed: true,
       licenseType: undefined,
       acceptedEula: false,
       trialsAllowed: 25,
       _id: 5c47252c2d9d6633a1bc9d46 } ],
  insertedCount: 1,
  insertedId: 5c47252c2d9d6633a1bc9d46 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T14:14:04.806Z|5706106376cb2743bcda30c0b636d125fb3201b71707a9e3ca0a622b269fda776c291dc0ed3c081b92d3778747053beca788e9743f7127651165470b4bd864ddd54cbab32bb82cf8f5c56b2b24a0996098ba21dc38673e6f7e63aa48b008ed8bc77ce4c2314e47252d66dfd9e5e8100ceca0cd2fffa744d25899da6bcafffc1d927bb08924ae7c31a62794a42636862bc7a85b99c4e14f265d00ac38b3066dac50a94da0f644d6d5f9fcd9cf16e53dbfaebc138368efdc630fdb9e3104849afe034b950b313d870550d375b3f031524cd85957d1b9f064253c89f8ee239e306e912a1d890852e96db0ea65fffc7fc3e5323ba5d8b782f897ed67f0fc20edbe6e
user--------111{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T14:14:04.792Z","lastLicenseCheck":"2019-01-22T14:14:04.792Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"2d29c7df-5009-45bf-8997-35a4be894804","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"acceptedEula":false,"trialsAllowed":25,"_id":"5c47252c2d9d6633a1bc9d46"}
userid--------111"2d29c7df-5009-45bf-8997-35a4be894804"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"2d29c7df-5009-45bf-8997-35a4be894804","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T14:14:04.806Z|5706106376cb2743bcda30c0b636d125fb3201b71707a9e3ca0a622b269fda776c291dc0ed3c081b92d3778747053beca788e9743f7127651165470b4bd864ddd54cbab32bb82cf8f5c56b2b24a0996098ba21dc38673e6f7e63aa48b008ed8bc77ce4c2314e47252d66dfd9e5e8100ceca0cd2fffa744d25899da6bcafffc1d927bb08924ae7c31a62794a42636862bc7a85b99c4e14f265d00ac38b3066dac50a94da0f644d6d5f9fcd9cf16e53dbfaebc138368efdc630fdb9e3104849afe034b950b313d870550d375b3f031524cd85957d1b9f064253c89f8ee239e306e912a1d890852e96db0ea65fffc7fc3e5323ba5d8b782f897ed67f0fc20edbe6e","clientSettings":""}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":true,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"lancer88888\",\"skin\":\"EduSkins_Alex\",\"oid\":\"2d29c7df-5009-45bf-8997-35a4be894804\",\"nickname\":\"lancer88888\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T14:14:04.806Z|5706106376cb2743bcda30c0b636d125fb3201b71707a9e3ca0a622b269fda776c291dc0ed3c081b92d3778747053beca788e9743f7127651165470b4bd864ddd54cbab32bb82cf8f5c56b2b24a0996098ba21dc38673e6f7e63aa48b008ed8bc77ce4c2314e47252d66dfd9e5e8100ceca0cd2fffa744d25899da6bcafffc1d927bb08924ae7c31a62794a42636862bc7a85b99c4e14f265d00ac38b3066dac50a94da0f644d6d5f9fcd9cf16e53dbfaebc138368efdc630fdb9e3104849afe034b950b313d870550d375b3f031524cd85957d1b9f064253c89f8ee239e306e912a1d890852e96db0ea65fffc7fc3e5323ba5d8b782f897ed67f0fc20edbe6e\",\"clientSettings\":\"\",\"acceptedEula\":false}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":true,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"lancer88888","skin":"EduSkins_Alex","oid":"2d29c7df-5009-45bf-8997-35a4be894804","nickname":"lancer88888","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|575bd4e8421b458ea8cc42b20fb0b73b|2019-02-01T14:14:04.806Z|5706106376cb2743bcda30c0b636d125fb3201b71707a9e3ca0a622b269fda776c291dc0ed3c081b92d3778747053beca788e9743f7127651165470b4bd864ddd54cbab32bb82cf8f5c56b2b24a0996098ba21dc38673e6f7e63aa48b008ed8bc77ce4c2314e47252d66dfd9e5e8100ceca0cd2fffa744d25899da6bcafffc1d927bb08924ae7c31a62794a42636862bc7a85b99c4e14f265d00ac38b3066dac50a94da0f644d6d5f9fcd9cf16e53dbfaebc138368efdc630fdb9e3104849afe034b950b313d870550d375b3f031524cd85957d1b9f064253c89f8ee239e306e912a1d890852e96db0ea65fffc7fc3e5323ba5d8b782f897ed67f0fc20edbe6e","clientSettings":"","acceptedEula":false}
进入eula方法
base64Decoded========{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"lancer88888","profile":{"name":"lancer88888","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1548166449,"nbf":1548166449,"exp":1548170349,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"218.241.251.176","oid":"575bd4e8421b458ea8cc42b20fb0b73b","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","upn":"lancer88888","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: lancer88888 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjY0NDksIm5iZiI6MTU0ODE2NjQ0OSwiZXhwIjoxNTQ4MTcwMzQ5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.WGKo2N5OoaZ-y7vVjpju3OftztcN6kacLfsvWnSAf7HKsDCvHF9zzE6kaR8LynViSaNd5P0xLzcyNCELJkhMqmbGUSwiZyN3lc5Yz0zrdgRPGlTIpiG6ENiGMJCoJwBTtAzIXiPAdhMlW1AaW1Ji6xoE5qb_w8rrGkXvikaDyF46Ip4tkBWSEvOMDowjUNPsOt8nMZJLMqxm2zKwHayO-LcvdkWYhwYrNau66h73hkizZHFYNNd5pyjJbuS_7AC1z6dsx3mcUEQulMDNHkzFdkVgUyBCfMoasunjcV8F9pazFkZj1WXjhTQMNZSPgFjbMXsb5TnokLIhTvdDrlnZvw","build":11000000,"clientVersion":342,"displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoibGFuY2VyODg4ODgiLCJhdWQiOiJodHRwczovL21lZXNlcnZpY2VzLm1pbmVjcmFmdC5uZXQiLCJpc3MiOiJodHRwczovL3d3dy5qZGNsb3VkLmNvbS8iLCJpYXQiOjE1NDgxNjY0NDksIm5iZiI6MTU0ODE2NjQ0OSwiZXhwIjoxNTQ4MTcwMzQ5LCJhY3IiOiIxIiwiYWlvIjoiNDIxQUFwRjYwUmZCajdzb2Z0MTgwRkYzdVZWTzFQIiwiYXBwaWQiOiJiMzZiMTQzMi0xYTFjLTRjODItOWI3Ni0yNGRlMWNhYjQyZjIiLCJhbXIiOlsicHdkIl0sImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiY2U4NDIwNWQtN2RlMi00YTc1LTgzYTgtNGY3YWJlODBmNjdjIiwiZmFtaWx5X25hbWUiOiJtaW5nIiwiZ2l2ZW5fbmFtZSI6InhpbmciLCJpcGFkZHIiOiIyMTguMjQxLjI1MS4xNzYiLCJvaWQiOiI1NzViZDRlODQyMWI0NThlYThjYzQyYjIwZmIwYjczYiIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJsYW5jZXI4ODg4OCIsInVwbiI6ImxhbmNlcjg4ODg4IiwidXRpIjoiUjc0TkZoZmQwRVdYOXdUUGhhUUxBQSIsInZlciI6IjEuMCJ9.WGKo2N5OoaZ-y7vVjpju3OftztcN6kacLfsvWnSAf7HKsDCvHF9zzE6kaR8LynViSaNd5P0xLzcyNCELJkhMqmbGUSwiZyN3lc5Yz0zrdgRPGlTIpiG6ENiGMJCoJwBTtAzIXiPAdhMlW1AaW1Ji6xoE5qb_w8rrGkXvikaDyF46Ip4tkBWSEvOMDowjUNPsOt8nMZJLMqxm2zKwHayO-LcvdkWYhwYrNau66h73hkizZHFYNNd5pyjJbuS_7AC1z6dsx3mcUEQulMDNHkzFdkVgUyBCfMoasunjcV8F9pazFkZj1WXjhTQMNZSPgFjbMXsb5TnokLIhTvdDrlnZvw","locale":"zh","osVersion":"10.0.17134","platform":"Windows Desktop Build (Win32)(x64)"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","userName":"lancer88888","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c47252c2d9d6633a1bc9d46","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"lancer88888","lastRoleCheck":"2019-01-22T14:14:04.792Z","lastLicenseCheck":"2019-01-22T14:14:04.792Z","role":"teacher","name":"lancer88888","oid":"575bd4e8421b458ea8cc42b20fb0b73b","anonimizedOid":"2d29c7df-5009-45bf-8997-35a4be894804","skin":"EduSkins_Alex","nickname":"lancer88888","isLicensed":true,"licenseType":null,"acceptedEula":false,"trialsAllowed":25}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '575bd4e8421b458ea8cc42b20fb0b73b',
  unique_name: 'lancer88888',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 307,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 123464,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 10152074,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 123513,
           [Symbol(triggerId)]: 123464 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 78 72 13 03 bb 36 00 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51606136,
     responseTo: 14011,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
action: http-error  tenantId: 404  unique_name: POST /sdk [Host|116.196.119.15:1337|Content-Length|441|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /nmaplowercheck1548169779 [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /HNAP1 [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /evox/about [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: POST /sdk [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Content-Length|441|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /nmaplowercheck1548198900 [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /HNAP1 [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
action: http-error  tenantId: 404  unique_name: GET /evox/about [Host|116.196.119.15:1337|User-Agent|Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)|Connection|close] details: {}
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1547710498,"exp":1547714398,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117","user_name":"test190117","full_name":"test190117","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","osVersion":"Win 10.0.16299.15","displayVersion":"1.0.27","platform":"Windows 10 UWP Build(x64)","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
连接数据库成功
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 319,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 686045,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51383971,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 686094,
           [Symbol(triggerId)]: 686045 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 e8 33 19 03 73 38 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51983336,
     responseTo: 79987,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入eula方法
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
连接数据库成功
进入retrieve方法数据库
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":false}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 331,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 686542,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51388521,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 686591,
           [Symbol(triggerId)]: 686542 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 2b 34 19 03 9b 38 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51983403,
     responseTo: 80027,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入getuserguid方法
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
action: getuserguid  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
registerUserGuid----"asdayryt"
registerUserGuid------------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
=========================={"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}======================
action: getuserguid-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
连接数据库成功
queryUserRole连接成功
queryUserRole连接成功"teacher"
insertEntity数据库地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359/UserGuid
连接数据库成功

action: setTrialCounts  tenantId:   unique_name:  details: {"id":"stu13@usmie.com","trialsAllowed":"24","trialsUsed":"3"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"stu15@usmie.com","trialsAllowed":"24","trialsUsed":"3"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: getUserInfo  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: deleteUser  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true}
userEntity------{"entity":{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-22T10:56:08.764Z","lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true},"exists":true}
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: undefined,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 393,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 690651,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51476749,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 690742,
           [Symbol(triggerId)]: 690651 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 0c 38 19 03 23 3a 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51984396,
     responseTo: 80419,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 395,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 690680,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51476750,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 690782,
           [Symbol(triggerId)]: 690680 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 11 38 19 03 29 3a 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51984401,
     responseTo: 80425,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:42:53.543Z|27960903a2169546f83dc607dd9807f43c7f9b82e570a54956fdc7aefbcbe90e39efea5eab4b28ac62677ca5b0445d1a79e33ab87d17f2b65c2fb2b90facbf2a61ff40dd6b611f140965bef1ea76ac97638689cb986a0f8f1e85efef577520189b717911df3b6f0c04f27c17a9efc57aafe2e49b9d9caeb8b59d9175aa42d4b4ac3dc09622e557d047397143565bd71b96bcffdad199247a38632c17601ae1d1a390b12d0cb136bb35d9ce27eb1388c45f3258d04a910b9e4783b21801803a94ce6df3678f63d365389f78b4e447f7069c463bfdd211eb7072313e84063069c44ba2541f4623531c3f04420e958919760c618640769c680ac0585442c2fc43ca
user--------111{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"trialsAllowed":25,"acceptedEula":true}
userid--------111"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","oid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:42:53.543Z|27960903a2169546f83dc607dd9807f43c7f9b82e570a54956fdc7aefbcbe90e39efea5eab4b28ac62677ca5b0445d1a79e33ab87d17f2b65c2fb2b90facbf2a61ff40dd6b611f140965bef1ea76ac97638689cb986a0f8f1e85efef577520189b717911df3b6f0c04f27c17a9efc57aafe2e49b9d9caeb8b59d9175aa42d4b4ac3dc09622e557d047397143565bd71b96bcffdad199247a38632c17601ae1d1a390b12d0cb136bb35d9ce27eb1388c45f3258d04a910b9e4783b21801803a94ce6df3678f63d365389f78b4e447f7069c463bfdd211eb7072313e84063069c44ba2541f4623531c3f04420e958919760c618640769c680ac0585442c2fc43ca","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"test190117\",\"skin\":\"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout\",\"oid\":\"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81\",\"nickname\":\"test190117\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:42:53.543Z|27960903a2169546f83dc607dd9807f43c7f9b82e570a54956fdc7aefbcbe90e39efea5eab4b28ac62677ca5b0445d1a79e33ab87d17f2b65c2fb2b90facbf2a61ff40dd6b611f140965bef1ea76ac97638689cb986a0f8f1e85efef577520189b717911df3b6f0c04f27c17a9efc57aafe2e49b9d9caeb8b59d9175aa42d4b4ac3dc09622e557d047397143565bd71b96bcffdad199247a38632c17601ae1d1a390b12d0cb136bb35d9ce27eb1388c45f3258d04a910b9e4783b21801803a94ce6df3678f63d365389f78b4e447f7069c463bfdd211eb7072313e84063069c44ba2541f4623531c3f04420e958919760c618640769c680ac0585442c2fc43ca\",\"clientSettings\":\"\",\"popup\":{\"id\":\"5c466b18-7982-4b90-9a20-94901f33c2b7\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \\\"C\\\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"},\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","oid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:42:53.543Z|27960903a2169546f83dc607dd9807f43c7f9b82e570a54956fdc7aefbcbe90e39efea5eab4b28ac62677ca5b0445d1a79e33ab87d17f2b65c2fb2b90facbf2a61ff40dd6b611f140965bef1ea76ac97638689cb986a0f8f1e85efef577520189b717911df3b6f0c04f27c17a9efc57aafe2e49b9d9caeb8b59d9175aa42d4b4ac3dc09622e557d047397143565bd71b96bcffdad199247a38632c17601ae1d1a390b12d0cb136bb35d9ce27eb1388c45f3258d04a910b9e4783b21801803a94ce6df3678f63d365389f78b4e447f7069c463bfdd211eb7072313e84063069c44ba2541f4623531c3f04420e958919760c618640769c680ac0585442c2fc43ca","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"},"acceptedEula":true}
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----{"iss":"https://www.jdcloud.com/","iat":1547710498,"exp":1547714398,"tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_oid":"3ca4b76ba18b4360b097189059cab4e3","unique_name":"test190117","user_name":"test190117","full_name":"test190117","identity_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
action: setSkin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","osVersion":"Win 10.0.16299.15","displayVersion":"1.0.27","platform":"Windows 10 UWP Build(x64)","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout"}
eeeewwwwww
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
连接数据库成功
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout' }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 411,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 693409,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51562931,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 693458,
           [Symbol(triggerId)]: 693409 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 78 3b 19 03 46 3b 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51985272,
     responseTo: 80710,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入eula方法
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
identity-----user{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
action: eula  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
eeeewwwwww
updateEula-------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":""}
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true}
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  unique_name: 'test190117',
  acceptedEula: true }
连接数据库成功
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 423,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 693924,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51567113,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 693973,
           [Symbol(triggerId)]: 693924 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 b4 3b 19 03 70 3b 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51985332,
     responseTo: 80752,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入getuserguid方法
base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
action: getuserguid  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
registerUserGuid----"asdayryt"
registerUserGuid------------{"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}
=========================={"tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","userName":"test190117","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg"}======================
action: getuserguid-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"clientVersion":"150","build":"10027000","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","ipAddress":"asdayryt"}
eeeewwwwww
连接数据库成功
queryUserRole连接成功
queryUserRole连接成功"teacher"
insertEntity数据库地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359/UserGuid
连接数据库成功

base64Decoded========{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}
解码后user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
fromToken----user{"userName":"test190117","profile":{"name":"test190117","aud":"https://meeservices.minecraft.net","iss":"https://www.jdcloud.com/","iat":1547710498,"nbf":1547710498,"exp":1547714398,"acr":"1","aio":"421AApF60RfBj7soft180FF3uVVO1P","appid":"b36b1432-1a1c-4c82-9b76-24de1cab42f2","amr":["pwd"],"appidacr":"0","deviceid":"ce84205d-7de2-4a75-83a8-4f7abe80f67c","family_name":"ming","given_name":"xing","ipaddr":"1.119.132.167","oid":"3ca4b76ba18b4360b097189059cab4e3","puid":"10037FFE9995AD69","scp":"user_impersonation","sub":"mee@jdcloud.com","tid":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","upn":"test190117","uti":"R74NFhfd0EWX9wTPhaQLAA","ver":"1.0"}}
$$$$$$$$$$$$$$$$$$###########@@@@@@@@@@!!!!!!!!!!^identity.uniqueName++++++++++这个事++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++少时诵诗书所所所test190117
UserID是这样来的[object Object]
action: server-signin  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"accessToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","build":"11000000","clientVersion":"342","displayVersion":"1.10.0","identityToken":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6IjJrazVUVFROTnRXaTZRMGJGYkkzZzNQTENJMD0ifQ.eyJuYW1lIjoidGVzdDE5MDExNyIsImF1ZCI6Imh0dHBzOi8vbWVlc2VydmljZXMubWluZWNyYWZ0Lm5ldCIsImlzcyI6Imh0dHBzOi8vd3d3LmpkY2xvdWQuY29tLyIsImlhdCI6MTU0NzcxMDQ5OCwibmJmIjoxNTQ3NzEwNDk4LCJleHAiOjE1NDc3MTQzOTgsImFjciI6IjEiLCJhaW8iOiI0MjFBQXBGNjBSZkJqN3NvZnQxODBGRjN1VlZPMVAiLCJhcHBpZCI6ImIzNmIxNDMyLTFhMWMtNGM4Mi05Yjc2LTI0ZGUxY2FiNDJmMiIsImFtciI6WyJwd2QiXSwiYXBwaWRhY3IiOiIwIiwiZGV2aWNlaWQiOiJjZTg0MjA1ZC03ZGUyLTRhNzUtODNhOC00ZjdhYmU4MGY2N2MiLCJmYW1pbHlfbmFtZSI6Im1pbmciLCJnaXZlbl9uYW1lIjoieGluZyIsImlwYWRkciI6IjEuMTE5LjEzMi4xNjciLCJvaWQiOiIzY2E0Yjc2YmExOGI0MzYwYjA5NzE4OTA1OWNhYjRlMyIsInB1aWQiOiIxMDAzN0ZGRTk5OTVBRDY5Iiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoibWVlQGpkY2xvdWQuY29tIiwidGlkIjoiMzhkZDY2MzQtMTkzMS00YzUwLWE5YjQtZDE2Y2Q5ZDk3ZDU3IiwidW5pcXVlX25hbWUiOiJ0ZXN0MTkwMTE3IiwidXBuIjoidGVzdDE5MDExNyIsInV0aSI6IlI3NE5GaGZkMEVXWDl3VFBoYVFMQUEiLCJ2ZXIiOiIxLjAifQ.gnp0l_R8TDt5AXNIib87n0Vmg0upi7-QRZUBhb2czYjlmvaUGYBucmKqUnQdiMzLH1YYs9Fh7nJazEXztlF88Hii1h6zA4F-923VqSxVy-E1OHF7xLJ_IniYc0j43Q3mYYkSeUxc_SixHJlAHE3TzMKyzAsXS2fKXZB1ZQtkqGgc_z0P7YX6huD9uSc3ndRzBU6qOy136-6lPwVXOVYU01nTmIdRC1wEikQjaHOydIldc98zerWt03cdf9kpf5G1RjJxYMisCQTlObgiU1PjhewkFiSSCGk_U4hwAn-oh3SAuVMHVbruCpznryh0TueIMJ5N92geLnLJ0683TEzslg","locale":"en","osVersion":"10.0.17763","platform":"Windows Desktop Build (Win32)(x64)","refreshToken":"_"}
eeeewwwwww
连接数据库成功
进入signTheUserIn
newTable
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true}
userEntity------{"entity":{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true},"exists":true}
isExistingUser-------true
1111111
action: signin-azurehelper-retrieveentity  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"entity":{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":null,"lastLicenseCheck":null,"role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"licenseType":null,"trialsAllowed":25,"acceptedEula":true},"exists":true}
-----getUserRoleRisky----111111
roleteacher
isExistingUser111
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: 2019-01-23T01:44:37.188Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
进入insertOrMerge
{ tenantId: '38dd6634-1931-4c50-a9b4-d16cd9d97d57',
  unique_name: 'test190117',
  lastRoleCheck: 2019-01-23T01:44:37.188Z,
  lastLicenseCheck: undefined,
  role: 'teacher',
  name: 'test190117',
  oid: '3ca4b76ba18b4360b097189059cab4e3',
  anonimizedOid: '45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81',
  skin: '1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout',
  nickname: 'test190117',
  isLicensed: true,
  licenseType: undefined,
  acceptedEula: true }
insertOrMerge更新数据
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 457,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 695710,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51580414,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 695811,
           [Symbol(triggerId)]: 695710 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 94 3c 19 03 18 3c 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51985556,
     responseTo: 80920,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
CommandResult {
  result:
   { n: 1,
     nModified: 0,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 459,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 695718,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 51580415,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 695817,
           [Symbol(triggerId)]: 695718 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 95 3c 19 03 19 3c 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 00 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 51985557,
     responseTo: 80921,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 0,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
sign-----------[object Object]
signedToken-----------38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:44:37.211Z|7ee1dd10edb25e1b6e4d8f0c683ecf2f2ff0cd9d12ed6d811548abd3aec9b62d9677281b5a473899ff6b3d23ce53294e9c1748c3ea3efd78fa8f349747349952ab505132b8c3eb3420284536ae91b690554c1d7ed2b6c16dc009c31418f844f32cd2f4477b80d93639e5d5db232c12512a558803f0ca2e49a73b360706736ab8d788366c7585a56893786419bf6b0894916f3c1dee48130520940814ad3cf0f17df748673fccff27a832b64b667c5cbe108698459d3cf88923037159f0738632b1ea4ee150eb701088c261d2c0a95f4ad438f9c4bac3923f7d810322b49662f878076052bde8c3f55b8d6a44ba1cbdce97e8f3752e885e051d53add1e86f2fd0
user--------111{"_id":"5c46f0f8f2246f6ef9afe6b7","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","unique_name":"test190117","lastRoleCheck":"2019-01-23T01:44:37.188Z","role":"teacher","name":"test190117","oid":"3ca4b76ba18b4360b097189059cab4e3","anonimizedOid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","nickname":"test190117","isLicensed":true,"trialsAllowed":25,"acceptedEula":true}
userid--------111"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81"
SignInResult--------111{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","oid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:44:37.211Z|7ee1dd10edb25e1b6e4d8f0c683ecf2f2ff0cd9d12ed6d811548abd3aec9b62d9677281b5a473899ff6b3d23ce53294e9c1748c3ea3efd78fa8f349747349952ab505132b8c3eb3420284536ae91b690554c1d7ed2b6c16dc009c31418f844f32cd2f4477b80d93639e5d5db232c12512a558803f0ca2e49a73b360706736ab8d788366c7585a56893786419bf6b0894916f3c1dee48130520940814ad3cf0f17df748673fccff27a832b64b667c5cbe108698459d3cf88923037159f0738632b1ea4ee150eb701088c261d2c0a95f4ad438f9c4bac3923f7d810322b49662f878076052bde8c3f55b8d6a44ba1cbdce97e8f3752e885e051d53add1e86f2fd0","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"}}
result---------[object Object]
action: signin-success  tenantId: 38dd6634-1931-4c50-a9b4-d16cd9d97d57  unique_name: test190117 details: {"message":"{\"isValid\":true,\"isLicensed\":true,\"isNewUser\":false,\"trialsRemaining\":0,\"role\":\"teacher\",\"tenantId\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57\",\"name\":\"test190117\",\"skin\":\"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout\",\"oid\":\"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81\",\"nickname\":\"test190117\",\"signedToken\":\"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:44:37.211Z|7ee1dd10edb25e1b6e4d8f0c683ecf2f2ff0cd9d12ed6d811548abd3aec9b62d9677281b5a473899ff6b3d23ce53294e9c1748c3ea3efd78fa8f349747349952ab505132b8c3eb3420284536ae91b690554c1d7ed2b6c16dc009c31418f844f32cd2f4477b80d93639e5d5db232c12512a558803f0ca2e49a73b360706736ab8d788366c7585a56893786419bf6b0894916f3c1dee48130520940814ad3cf0f17df748673fccff27a832b64b667c5cbe108698459d3cf88923037159f0738632b1ea4ee150eb701088c261d2c0a95f4ad438f9c4bac3923f7d810322b49662f878076052bde8c3f55b8d6a44ba1cbdce97e8f3752e885e051d53add1e86f2fd0\",\"clientSettings\":\"\",\"popup\":{\"id\":\"5c466b18-7982-4b90-9a20-94901f33c2b7\",\"title\":\"Code Builder for Minecraft: Education Edition\",\"text\":\"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \\\"C\\\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.\",\"hyperlinkIntroText\":\"\",\"hyperlink\":\"https://education.minecraft.net/CS\",\"hyperlinkLabel\":\"education.minecraft.net/CS\",\"okButtonAction\":\"DismissAndStartGame\"},\"acceptedEula\":true}"}
eeeewwwwww
连接数据库成功
----------------------signin-success-----------------{"isValid":true,"isLicensed":true,"isNewUser":false,"trialsRemaining":0,"role":"teacher","tenantId":"38dd6634-1931-4c50-a9b4-d16cd9d97d57","name":"test190117","skin":"1ece5830-0b47-4511-8b67-04df547a4d9e_RedScout","oid":"45cd03c3-e0e7-4ebd-90b0-4c3d2fe60a81","nickname":"test190117","signedToken":"38dd6634-1931-4c50-a9b4-d16cd9d97d57|3ca4b76ba18b4360b097189059cab4e3|2019-02-02T01:44:37.211Z|7ee1dd10edb25e1b6e4d8f0c683ecf2f2ff0cd9d12ed6d811548abd3aec9b62d9677281b5a473899ff6b3d23ce53294e9c1748c3ea3efd78fa8f349747349952ab505132b8c3eb3420284536ae91b690554c1d7ed2b6c16dc009c31418f844f32cd2f4477b80d93639e5d5db232c12512a558803f0ca2e49a73b360706736ab8d788366c7585a56893786419bf6b0894916f3c1dee48130520940814ad3cf0f17df748673fccff27a832b64b667c5cbe108698459d3cf88923037159f0738632b1ea4ee150eb701088c261d2c0a95f4ad438f9c4bac3923f7d810322b49662f878076052bde8c3f55b8d6a44ba1cbdce97e8f3752e885e051d53add1e86f2fd0","clientSettings":"","popup":{"id":"5c466b18-7982-4b90-9a20-94901f33c2b7","title":"Code Builder for Minecraft: Education Edition","text":"Did you know you can write code in Minecraft? Code Builder is now available for students in game! You can press \"C\" to code while in a world to control the Agent with block code or JavaScript. Head to our computer science landing page for training, lesson plans, and resources on coding with Minecraft.","hyperlinkIntroText":"","hyperlink":"https://education.minecraft.net/CS","hyperlinkLabel":"education.minecraft.net/CS","okButtonAction":"DismissAndStartGame"},"acceptedEula":true}
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"stu15@usmie.com","trialsAllowed":"24","trialsUsed":"3"}
eeeewwwwww
看一下这个data：undefined
连接数据库成功
action: getUserInfo  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: deleteUser  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: getUserInfo  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：undefined
action: setTrialCounts  tenantId:   unique_name:  details: {"id":"stu15@usmie.com","trialsAllowed":"24","trialsUsed":"3"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c47cd319f9d5cb568b98b73","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"dd8ec105-f4a2-40bd-8e73-54c20d4559bd","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"licenseType":null}
进入user
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c47cd319f9d5cb568b98b73","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"dd8ec105-f4a2-40bd-8e73-54c20d4559bd","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"licenseType":null}
进入insertOrMerge
{ tenantId: '38dd6634-1031-4c50-a9b4-d16cd9d97d57',
  oid: 'd2bb1fae-fe7e-4473-a161-92aefee52a3d',
  unique_name: 'stu15@usmie.com',
  trialsAllowed: 24,
  trialsUsed: 3 }
insertOrMerge更新数据
CommandResult {
  result:
   { n: 1,
     nModified: 1,
     opTime: { ts: [Timestamp], t: 1 },
     electionId: 7fffffff0000000000000001,
     ok: 1 },
  connection:
   Connection {
     _events:
      [Object: null prototype] {
        error: [Function],
        close: [Function],
        timeout: [Function],
        parseError: [Function] },
     _eventsCount: 4,
     _maxListeners: undefined,
     options:
      { host: '192.168.0.55',
        port: 27017,
        size: 20,
        minSize: 0,
        connectionTimeout: 30000,
        socketTimeout: 360000,
        keepAlive: true,
        keepAliveInitialDelay: 300000,
        noDelay: true,
        ssl: false,
        checkServerIdentity: true,
        ca: null,
        crl: null,
        cert: null,
        key: null,
        passPhrase: null,
        rejectUnauthorized: false,
        promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false,
        reconnect: false,
        reconnectInterval: 1000,
        reconnectTries: 30,
        domainsEnabled: false,
        disconnectHandler: [Store],
        cursorFactory: [Function],
        emitError: true,
        monitorCommands: false,
        setName: 'mgset-2242988359',
        auto_reconnect: true,
        poolSize: 20,
        promiseLibrary: [Function: Promise],
        clientInfo: [Object],
        authProviders: [Object],
        monitoring: false,
        parent: [ReplSet],
        servers: [Array],
        replicaSet: 'mgset-2242988359',
        caseTranslate: true,
        useNewUrlParser: true,
        username: 'root',
        password: 'Eq9RQ80J',
        db: 'admin',
        auth: [Object],
        user: 'root',
        authSource: 'admin',
        dbName: 'admin',
        socketTimeoutMS: 360000,
        connectTimeoutMS: 30000,
        bson: BSON {} },
     id: 511,
     logger: Logger { className: 'Connection' },
     bson: BSON {},
     tag: undefined,
     messageHandler: [Function],
     maxBsonMessageSize: 67108864,
     port: 27017,
     host: '192.168.0.55',
     family: undefined,
     keepAlive: true,
     keepAliveInitialDelay: 300000,
     noDelay: true,
     connectionTimeout: 30000,
     socketTimeout: 360000,
     destroyed: false,
     domainSocket: false,
     singleBufferSerializtion: true,
     serializationFunction: 'toBinUnified',
     ca: null,
     crl: null,
     cert: null,
     key: null,
     passphrase: null,
     ciphers: null,
     ecdhCurve: null,
     ssl: false,
     rejectUnauthorized: false,
     checkServerIdentity: true,
     responseOptions:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     flushing: false,
     queue: [],
     connection:
      Socket {
        connecting: false,
        _hadError: false,
        _handle: [TCP],
        _parent: null,
        _host: null,
        _readableState: [ReadableState],
        readable: true,
        _events: [Object],
        _eventsCount: 5,
        _maxListeners: undefined,
        _writableState: [WritableState],
        writable: true,
        allowHalfOpen: false,
        _sockname: null,
        _pendingData: null,
        _pendingEncoding: '',
        server: null,
        _server: null,
        timeout: 360000,
        [Symbol(asyncId)]: 753047,
        [Symbol(lastWriteQueueSize)]: 0,
        [Symbol(timeout)]:
         Timeout {
           _called: false,
           _idleTimeout: 360000,
           _idlePrev: [TimersList],
           _idleNext: [Timeout],
           _idleStart: 53407824,
           _onTimeout: [Function: bound ],
           _timerArgs: undefined,
           _repeat: null,
           _destroyed: false,
           [Symbol(unrefed)]: true,
           [Symbol(asyncId)]: 753096,
           [Symbol(triggerId)]: 753047 },
        [Symbol(kBytesRead)]: 0,
        [Symbol(kBytesWritten)]: 0 },
     writeStream: null,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8',
     workItems: [],
     buffer: null,
     sizeOfMessage: 0,
     bytesRead: 0,
     stubBuffer: null },
  message:
   Response {
     parsed: true,
     raw:
      <Buffer 87 00 00 00 77 85 19 03 0d 56 01 00 01 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d ... >,
     data:
      <Buffer 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 63 00 00 00 10 6e 00 01 00 00 00 10 6e 4d 6f 64 69 66 69 65 64 00 01 00 00 00 03 6f 70 54 ... >,
     bson: BSON {},
     opts:
      { promoteLongs: true,
        promoteValues: true,
        promoteBuffers: false },
     length: 135,
     requestId: 52004215,
     responseTo: 87565,
     opCode: 1,
     fromCompressed: undefined,
     responseFlags: 8,
     cursorId: Long { _bsontype: 'Long', low_: 0, high_: 0 },
     startingFrom: 0,
     numberReturned: 1,
     documents: [ [Object] ],
     cursorNotFound: false,
     queryFailure: false,
     shardConfigStale: false,
     awaitCapable: true,
     promoteLongs: true,
     promoteValues: true,
     promoteBuffers: false,
     index: 119,
     hashedName: '693f21c69a2537a5d5c4a32e9370ec8052dbcdd8' },
  modifiedCount: 1,
  upsertedId: null,
  upsertedCount: 0,
  matchedCount: 1 }
进入retrieve方法
AzureTabl数据库连接地址mongodb://root:Eq9RQ80J@jmongo-hb1-prod-mongo-t392nvqc111.jmiss.jdcloud.com:27017,jmongo-hb1-prod-mongo-t392nvqc112.jmiss.jdcloud.com:27017/admin?replicaSet=mgset-2242988359
进入retrieve方法数据库
final+{"_id":"5c47cd319f9d5cb568b98b73","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"dd8ec105-f4a2-40bd-8e73-54c20d4559bd","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"licenseType":null,"trialsAllowed":24,"trialsUsed":3}
action: getUserInfo  tenantId:   unique_name:  details: {"message":"stu15@usmie.com"}
eeeewwwwww
连接数据库成功
看一下这个data：{"_id":"5c47cd319f9d5cb568b98b73","tenantId":"38dd6634-1031-4c50-a9b4-d16cd9d97d57","unique_name":"stu15@usmie.com","lastRoleCheck":null,"lastLicenseCheck":null,"role":"student","name":"ブラック フラグ","oid":"d2bb1fae-fe7e-4473-a161-92aefee52a3d","anonimizedOid":"dd8ec105-f4a2-40bd-8e73-54c20d4559bd","skin":"EduSkins_Alex","nickname":"stu15u","isLicensed":true,"licenseType":null,"trialsAllowed":24,"trialsUsed":3}
